<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [OpenIMSCore-Users] OpenIMSCore-Users Digest, Vol 8,	Issue 21 Call Between bob and Alice
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/openimscore-users/2007-June/index.html" >
   <LINK REL="made" HREF="mailto:openimscore-users%40lists.berlios.de?Subject=Re%3A%20%5BOpenIMSCore-Users%5D%20OpenIMSCore-Users%20Digest%2C%20Vol%208%2C%0A%09Issue%2021%20Call%20Between%20bob%20and%20Alice&In-Reply-To=%3C000601c7af40%24971545f0%240b00000a%40CRIAI.IT%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002014.html">
   <LINK REL="Next"  HREF="001975.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[OpenIMSCore-Users] OpenIMSCore-Users Digest, Vol 8,	Issue 21 Call Between bob and Alice</H1>
    <B>Alessandro Stile</B> 
    <A HREF="mailto:openimscore-users%40lists.berlios.de?Subject=Re%3A%20%5BOpenIMSCore-Users%5D%20OpenIMSCore-Users%20Digest%2C%20Vol%208%2C%0A%09Issue%2021%20Call%20Between%20bob%20and%20Alice&In-Reply-To=%3C000601c7af40%24971545f0%240b00000a%40CRIAI.IT%3E"
       TITLE="[OpenIMSCore-Users] OpenIMSCore-Users Digest, Vol 8,	Issue 21 Call Between bob and Alice">a.stile at criai.it
       </A><BR>
    <I>Fri Jun 15 12:59:00 CEST 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="002014.html">[OpenIMSCore-Users] Query on IPSec at P-CSCF (Registeration)
</A></li>
        <LI>Next message: <A HREF="001975.html">[OpenIMSCore-Users] call flow: AS INVITE with Request-URI != URI	for our domain
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1974">[ date ]</a>
              <a href="thread.html#1974">[ thread ]</a>
              <a href="subject.html#1974">[ subject ]</a>
              <a href="author.html#1974">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi PA, thanks for response but in my INVITE message I don't see Route 
header,  I think the problem is my x-lite configuration, what do you think 
about utc ims client?
Best regards Alessandro Stile
----- Original Message ----- 
From: &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">openimscore-users-request at lists.berlios.de</A>&gt;
To: &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">openimscore-users at lists.berlios.de</A>&gt;
Sent: Thursday, June 14, 2007 6:21 PM
Subject: OpenIMSCore-Users Digest, Vol 8, Issue 21


&gt;<i> Send OpenIMSCore-Users mailing list submissions to
</I>&gt;<i> <A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">openimscore-users at lists.berlios.de</A>
</I>&gt;<i>
</I>&gt;<i> To subscribe or unsubscribe via the World Wide Web, visit
</I>&gt;<i> <A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">https://lists.berlios.de/mailman/listinfo/openimscore-users</A>
</I>&gt;<i> or, via email, send a message with subject or body 'help' to
</I>&gt;<i> <A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">openimscore-users-request at lists.berlios.de</A>
</I>&gt;<i>
</I>&gt;<i> You can reach the person managing the list at
</I>&gt;<i> <A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">openimscore-users-owner at lists.berlios.de</A>
</I>&gt;<i>
</I>&gt;<i> When replying, please edit your Subject line so it is more specific
</I>&gt;<i> than &quot;Re: Contents of OpenIMSCore-Users digest...&quot;
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Today's Topics:
</I>&gt;<i>
</I>&gt;<i>   1. Re: Call between Bob and Aluce (Tran Minh Phuong Anh)
</I>&gt;<i>   2. Re: Problem during re-registration : 401 response ? (JF)
</I>&gt;<i>   3.  IMS services (Nacho Conde)
</I>&gt;<i>   4. Re: Problem during re-registration : 401 response ?
</I>&gt;<i>      (Dragos Vingarzan)
</I>&gt;<i>   5. Re: Problem during re-registration : 401 response ? (JF)
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> ----------------------------------------------------------------------
</I>&gt;<i>
</I>&gt;<i> Message: 1
</I>&gt;<i> Date: Thu, 14 Jun 2007 17:15:07 +0200
</I>&gt;<i> From: &quot;Tran Minh Phuong Anh&quot; &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">tran.minh.phuong.anh at gmail.com</A>&gt;
</I>&gt;<i> Subject: Re: [OpenIMSCore-Users] Call between Bob and Aluce
</I>&gt;<i> To: &quot;Alessandro Stile&quot; &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">a.stile at criai.it</A>&gt;,
</I>&gt;<i> <A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">openimscore-users at lists.berlios.de</A>
</I>&gt;<i> Message-ID:
</I>&gt;<i> &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">9b7ddabe0706140815o65454333hd1acb25873878989 at mail.gmail.com</A>&gt;
</I>&gt;<i> Content-Type: text/plain; charset=ISO-8859-1; format=flowed
</I>&gt;<i>
</I>&gt;<i> On 6/14/07, Alessandro Stile &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">a.stile at criai.it</A>&gt; wrote:
</I>&gt;&gt;<i> alice Registration is right I can see 200 Ok message with Service-Route
</I>&gt;&gt;<i> Header. But when alice tries to call bob I see  400 Bad request non
</I>&gt;&gt;<i> following indicated service route.
</I>&gt;<i>
</I>&gt;&gt;<i> What is wrong? I think the problemis the client because it dosen't use
</I>&gt;&gt;<i> Service-Route header in INVITE message, isn't it?
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Hi,
</I>&gt;<i>
</I>&gt;<i> You're right, the value of Service-Route header in 200 OK for REGISTER
</I>&gt;<i> should be in the INVITE message as a Route header.
</I>&gt;<i>
</I>&gt;<i> PA
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> ------------------------------
</I>&gt;<i>
</I>&gt;<i> Message: 2
</I>&gt;<i> Date: Thu, 14 Jun 2007 17:03:50 +0100
</I>&gt;<i> From: JF &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">jfkavaka at gmail.com</A>&gt;
</I>&gt;<i> Subject: Re: [OpenIMSCore-Users] Problem during re-registration : 401
</I>&gt;<i> response ?
</I>&gt;<i> To: &quot;Dragos Vingarzan&quot; &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">vingarzan at fokus.fraunhofer.de</A>&gt;
</I>&gt;<i> Cc: <A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">openimscore-users at lists.berlios.de</A>
</I>&gt;<i> Message-ID:
</I>&gt;<i> &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">b33002040706140903m2bb5ec41se209919de446a4fc at mail.gmail.com</A>&gt;
</I>&gt;<i> Content-Type: text/plain; charset=ISO-8859-1; format=flowed
</I>&gt;<i>
</I>&gt;<i> Hi all,
</I>&gt;<i>
</I>&gt;<i> I was testing with a SIP-enabled DSL router that sends in the
</I>&gt;<i> de-REGISTER the same MD5 Authorization header sent previously in the
</I>&gt;<i> REGISTER.
</I>&gt;<i> With the current behaviour the de-REGISTRATION doesn't succeed because
</I>&gt;<i> the REGISTER (with Expires=0) is challenged but this client does not
</I>&gt;<i> support responding to challenges in de-REGISTERs...
</I>&gt;<i>
</I>&gt;<i> I was able to solve it by modifying 
</I>&gt;<i> scscf/registration.c::S_is_authorized():
</I>&gt;<i>
</I>&gt;<i> if (response16.len==expected_len &amp;&amp;
</I>&gt;<i> strncasecmp(response16.s,expected,response16.len)==0){
</I>&gt;<i>                if (av-&gt;type==AUTH_AKAV1_MD5 ||
</I>&gt;<i> av-&gt;type==AUTH_AKAV2_MD5)  // ADDED BECAUSE SOME CLIENTS SEND
</I>&gt;<i> Authorization header with the same MD5 response in de-registers and
</I>&gt;<i> re-registers with no Gm security
</I>&gt;<i>                        av-&gt;status = AUTH_VECTOR_USELESS;
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> I understand that invalidating the auth vectors making them one-time
</I>&gt;<i> usable brings improved security for MD5, but do you agree with having
</I>&gt;<i> a configurable flag for choosing whether the auth vector can be reused
</I>&gt;<i> for MD5? I can send the patch.
</I>&gt;<i>
</I>&gt;<i> Thanks,
</I>&gt;<i> JF
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> On 6/11/07, Dragos Vingarzan &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">vingarzan at fokus.fraunhofer.de</A>&gt; wrote:
</I>&gt;&gt;<i> Hello Frederic,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Well, because authentication vectors are treated int he same way. In the
</I>&gt;&gt;<i> end it is hard to please everyone in all the specs 3GPP, TISPAN,
</I>&gt;&gt;<i> PacketCable or IETF on the same platform. So we took the approach of
</I>&gt;&gt;<i> invalidating the vectors after one usage.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> In general, by re-registration in IMS I understand a REGISTER sent over
</I>&gt;&gt;<i> a secure connection - because converged security is one the main IMS
</I>&gt;&gt;<i> features, right? Then if re-registration happens over a secure channel
</I>&gt;&gt;<i> it won't be challenged/authenticated so anyway there is no need for
</I>&gt;&gt;<i> keeping the authentication vectors valid and reusing them. If you are
</I>&gt;&gt;<i> not using any kind of security for the Gm interface then I think that
</I>&gt;&gt;<i> you are missing most of the IMS value and you are outside the current
</I>&gt;&gt;<i> target of the Open IMS Core.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> For Gm security we now have IPSec. There is also a functional TLS branch
</I>&gt;&gt;<i> that we will try to merge very soon in the trunk.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Cheers,
</I>&gt;&gt;<i> -Dragos
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Babon Frederic wrote:
</I>&gt;&gt;<i> &gt; Thanks for your explanation !
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; In my case, I am using MD5 and you said that one-time vectors does not 
</I>&gt;&gt;<i> &gt; apply to MD5, so why my authentication vector is no longer valid when I 
</I>&gt;&gt;<i> &gt; try to re-register?
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; Frederic.
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; -----Message d'origine-----
</I>&gt;&gt;<i> &gt; De : Dragos Vingarzan [mailto:<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">vingarzan at fokus.fraunhofer.de</A>]
</I>&gt;&gt;<i> &gt; Envoy? : lundi 4 juin 2007 11:16
</I>&gt;&gt;<i> &gt; ? : Verbeiren, David
</I>&gt;&gt;<i> &gt; Cc : Babon Frederic; <A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">openimscore-users at lists.berlios.de</A>
</I>&gt;&gt;<i> &gt; Objet : Re: [OpenIMSCore-Users] Problem during re-registration : 401 
</I>&gt;&gt;<i> &gt; response ?
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; Hi David,
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; You are right. The authentication vectors are treated as one-time valid
</I>&gt;&gt;<i> &gt; ones. This means that each authentication vector can be used exactly
</I>&gt;&gt;<i> &gt; once to test a response for correctness (irrespective if it is correct
</I>&gt;&gt;<i> &gt; or not). This is a must for AKA. I have seen that it is not for MD5, 
</I>&gt;&gt;<i> &gt; but
</I>&gt;&gt;<i> &gt; I think that the extra security that this one-time usage brings is 
</I>&gt;&gt;<i> &gt; worth
</I>&gt;&gt;<i> &gt; the effort of creating new authentication vectors (plus that the S-CSCF
</I>&gt;&gt;<i> &gt; can request more than 1 auth vector at a time).
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; So then re-registration is simpler and quicker only if the client uses 
</I>&gt;&gt;<i> &gt; a
</I>&gt;&gt;<i> &gt; IPSec or TLS security mechanism with the P-CSCF so that the security of
</I>&gt;&gt;<i> &gt; the REGISTER message is granted. Then an integrity-protected=yes value
</I>&gt;&gt;<i> &gt; will be present in the Authorization header and the S-CSCF won't
</I>&gt;&gt;<i> &gt; challenge it.
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; About compatibility, I think that any client should be ready to act at
</I>&gt;&gt;<i> &gt; any time to 401/407 responses.
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; -Dragos
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; Verbeiren, David wrote:
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt;&gt; Hi Frederic,
</I>&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt; Based on the behavior I've seen from the CSCFs (i.e. not based on code 
</I>&gt;&gt;<i> &gt;&gt; walkthrough), I think the log message means that the auth vector that 
</I>&gt;&gt;<i> &gt;&gt; the CSCF got from the HSS during initial registration has been removed 
</I>&gt;&gt;<i> &gt;&gt; from a local cache somehow and that, upon receiving 401, your UE has 
</I>&gt;&gt;<i> &gt;&gt; to respond to the new challenge (i.e. new REGISTER with response to 
</I>&gt;&gt;<i> &gt;&gt; the new challenge). And I don't think - again only based on observed 
</I>&gt;&gt;<i> &gt;&gt; behavior so far -, that the time an auth vector remains in the cache 
</I>&gt;&gt;<i> &gt;&gt; is related in any way to the registration expiry time negotiated 
</I>&gt;&gt;<i> &gt;&gt; during initial registration.
</I>&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt; Also, I do not know whether this behavior is correct or not. It seems 
</I>&gt;&gt;<i> &gt;&gt; a bit odd because it makes the re-registration really behave as a 
</I>&gt;&gt;<i> &gt;&gt; fresh registration as soon as the auth vector is not in the cache 
</I>&gt;&gt;<i> &gt;&gt; anymore...
</I>&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt; Just my 2c.
</I>&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt; -David
</I>&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt; ________________________________________
</I>&gt;&gt;<i> &gt;&gt; From: <A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">openimscore-users-bounces at lists.berlios.de</A> 
</I>&gt;&gt;<i> &gt;&gt; [mailto:<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">openimscore-users-bounces at lists.berlios.de</A>] On Behalf Of Babon 
</I>&gt;&gt;<i> &gt;&gt; Frederic
</I>&gt;&gt;<i> &gt;&gt; Sent: 01 June 2007 18:35
</I>&gt;&gt;<i> &gt;&gt; To: <A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">openimscore-users at lists.berlios.de</A>
</I>&gt;&gt;<i> &gt;&gt; Subject: [OpenIMSCore-Users] Problem during re-registration : 401 
</I>&gt;&gt;<i> &gt;&gt; response ?
</I>&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt; Hello,
</I>&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt; I have a problem when i try to do a re-registration: the server reply 
</I>&gt;&gt;<i> &gt;&gt; by a 401 unauthorized sip message.
</I>&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt; If I take a look at the CSCF trace log I can see: no matching auth 
</I>&gt;&gt;<i> &gt;&gt; vector found - maybe timer expired
</I>&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt; Is that mean that I have to send my re-registration message one second 
</I>&gt;&gt;<i> &gt;&gt; before registration timeout or something like this?
</I>&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt; The CSCF should wait a little more before disabling registration?
</I>&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt; This is the corresponding ethereal trace:
</I>&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt; REQUEST
</I>&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt; Frame 119 (707 bytes on wire, 707 bytes captured)
</I>&gt;&gt;<i> &gt;&gt; Ethernet II, Src: 00:11:25:55:22:e8, Dst: 00:0c:29:3d:20:09
</I>&gt;&gt;<i> &gt;&gt; Internet Protocol, Src Addr: 178.3.3.57 (178.3.3.57), Dst Addr: 
</I>&gt;&gt;<i> &gt;&gt; 178.3.3.30 (178.3.3.30)
</I>&gt;&gt;<i> &gt;&gt; User Datagram Protocol, Src Port: 5070 (5070), Dst Port: 5060 (5060)
</I>&gt;&gt;<i> &gt;&gt; Session Initiation Protocol
</I>&gt;&gt;<i> &gt;&gt;     Request-Line: REGISTER sip:test.net SIP/2.0
</I>&gt;&gt;<i> &gt;&gt;         Method: REGISTER
</I>&gt;&gt;<i> &gt;&gt;     Message Header
</I>&gt;&gt;<i> &gt;&gt;         Via: SIP/2.0/UDP 
</I>&gt;&gt;<i> &gt;&gt; 178.3.3.57:5070;rport;branch=z9hG4bKPj8bba4284637b40fb8b89684b9b95f2cb
</I>&gt;&gt;<i> &gt;&gt;         Route: &lt;sip:pcscf.test.net:5060;lr&gt;
</I>&gt;&gt;<i> &gt;&gt;         Max-Forwards: 70
</I>&gt;&gt;<i> &gt;&gt;         From: 
</I>&gt;&gt;<i> &gt;&gt; &lt;sip:<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">fbabon at test.net</A>&gt;;tag=4985f8994a1b43f4b9612976af86df94
</I>&gt;&gt;<i> &gt;&gt;         To: &lt;sip:<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">fbabon at test.net</A>&gt;
</I>&gt;&gt;<i> &gt;&gt;         Call-ID: c7936cc9979e4523b293fd17bf47f3c1
</I>&gt;&gt;<i> &gt;&gt;         CSeq: 41426 REGISTER
</I>&gt;&gt;<i> &gt;&gt;         User-Agent: SmartBox
</I>&gt;&gt;<i> &gt;&gt;         Contact: &lt;sip:<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">fbabon at 178.3.3.57</A>:5070;transport=UDP&gt;
</I>&gt;&gt;<i> &gt;&gt;         Expires: 30
</I>&gt;&gt;<i> &gt;&gt;         Authorization: Digest username=&quot;<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">fbabon_private1 at test.net</A>&quot;, 
</I>&gt;&gt;<i> &gt;&gt; realm=&quot;test.net&quot;, nonce=&quot;31733e7d0be15bef21d5ee6644d67a58&quot;, 
</I>&gt;&gt;<i> &gt;&gt; uri=&quot;sip:test.net&quot;, response=&quot;5a49954854b3d332b7ef98e27f88c41c&quot;, 
</I>&gt;&gt;<i> &gt;&gt; algorithm=md5
</I>&gt;&gt;<i> &gt;&gt;     Message body
</I>&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt; RESPONSE
</I>&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt; Frame 120 (881 bytes on wire, 881 bytes captured)
</I>&gt;&gt;<i> &gt;&gt; Ethernet II, Src: 00:0c:29:3d:20:09, Dst: 00:11:25:55:22:e8
</I>&gt;&gt;<i> &gt;&gt; Internet Protocol, Src Addr: 178.3.3.30 (178.3.3.30), Dst Addr: 
</I>&gt;&gt;<i> &gt;&gt; 178.3.3.57 (178.3.3.57)
</I>&gt;&gt;<i> &gt;&gt; User Datagram Protocol, Src Port: 5060 (5060), Dst Port: 5070 (5070)
</I>&gt;&gt;<i> &gt;&gt; Session Initiation Protocol
</I>&gt;&gt;<i> &gt;&gt;     Status-Line: SIP/2.0 401 Unauthorized - Challenging the UE
</I>&gt;&gt;<i> &gt;&gt;         Status-Code: 401
</I>&gt;&gt;<i> &gt;&gt;     Message Header
</I>&gt;&gt;<i> &gt;&gt;         Via: SIP/2.0/UDP 
</I>&gt;&gt;<i> &gt;&gt; 178.3.3.57:5070;received=178.3.3.57;rport=5070;branch=z9hG4bKPj8bba4284637b40fb8b89684b9b95f2cb
</I>&gt;&gt;<i> &gt;&gt;         From: 
</I>&gt;&gt;<i> &gt;&gt; &lt;sip:<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">fbabon at test.net</A>&gt;;tag=4985f8994a1b43f4b9612976af86df94
</I>&gt;&gt;<i> &gt;&gt;         To: 
</I>&gt;&gt;<i> &gt;&gt; &lt;sip:<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">fbabon at test.net</A>&gt;;tag=52d5f3a3b88eb39fcd217d749091994e-c85e
</I>&gt;&gt;<i> &gt;&gt;         Call-ID: c7936cc9979e4523b293fd17bf47f3c1
</I>&gt;&gt;<i> &gt;&gt;         CSeq: 41426 REGISTER
</I>&gt;&gt;<i> &gt;&gt;         Path: &lt;sip:<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">term at pcscf.test.net</A>:5060;lr&gt;
</I>&gt;&gt;<i> &gt;&gt;         Service-Route: &lt;sip:<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">orig at scscf.test.net</A>:6060;lr&gt;
</I>&gt;&gt;<i> &gt;&gt;         Server: Sip EXpress router (2.1.0-dev1 OpenIMSCore 
</I>&gt;&gt;<i> &gt;&gt; (i386/linux))
</I>&gt;&gt;<i> &gt;&gt;         Content-Length: 0
</I>&gt;&gt;<i> &gt;&gt;         Warning: 392 178.3.3.30:6060 &quot;Noisy feedback tells:  pid=1072 
</I>&gt;&gt;<i> &gt;&gt; req_src_ip=178.3.3.30 req_src_port=4060 in_uri=sip:scscf.test.net:6060 
</I>&gt;&gt;<i> &gt;&gt; out_uri=sip:scscf.test.net:6060 via_cnt==3&quot;
</I>&gt;&gt;<i> &gt;&gt;         WWW-Authenticate: Digest realm=&quot;test.net&quot;, 
</I>&gt;&gt;<i> &gt;&gt; nonce=&quot;e8445d47dd69542ad7ba6fb3ba195cac&quot;, algorithm=MD5
</I>&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt; Thanks a lot for your help.
</I>&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt; Frederic Babon
</I>&gt;&gt;<i> &gt;&gt; _______________________________________________
</I>&gt;&gt;<i> &gt;&gt; OpenIMSCore-Users mailing list
</I>&gt;&gt;<i> &gt;&gt; <A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">OpenIMSCore-Users at lists.berlios.de</A>
</I>&gt;&gt;<i> &gt;&gt; <A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">https://lists.berlios.de/mailman/listinfo/openimscore-users</A>
</I>&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> --
</I>&gt;&gt;<i> -----------------------------------------
</I>&gt;&gt;<i> Dipl. Eng. Dragos Vingarzan
</I>&gt;&gt;<i> Fraunhofer FOKUS/NGNI
</I>&gt;&gt;<i> Kaiserin-Augusta-Allee 31
</I>&gt;&gt;<i> 10589 Berlin,Germany
</I>&gt;&gt;<i> Phone +49 (0)30 - 3463 - 7385
</I>&gt;&gt;<i> Mobile +49 (0)163 - 159 - 5221
</I>&gt;&gt;<i> Web www.fokus.fraunhofer.de www.openimscore.org
</I>&gt;&gt;<i> We could change the world if God would give us the source code...
</I>&gt;&gt;<i> -----------------------------------------------------------------
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i> OpenIMSCore-Users mailing list
</I>&gt;&gt;<i> <A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">OpenIMSCore-Users at lists.berlios.de</A>
</I>&gt;&gt;<i> <A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">https://lists.berlios.de/mailman/listinfo/openimscore-users</A>
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> ------------------------------
</I>&gt;<i>
</I>&gt;<i> Message: 3
</I>&gt;<i> Date: Thu, 14 Jun 2007 17:57:21 +0200
</I>&gt;<i> From: Nacho Conde &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">ics266 at tid.es</A>&gt;
</I>&gt;<i> Subject: [OpenIMSCore-Users]  IMS services
</I>&gt;<i> To: <A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">openimscore-users at lists.berlios.de</A>
</I>&gt;<i> Message-ID: &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">46716561.6050903 at tid.es</A>&gt;
</I>&gt;<i> Content-Type: text/plain; format=flowed; charset=ISO-8859-1
</I>&gt;<i>
</I>&gt;<i> Hello, we are testing the open ims core, at the moment all works Ok.
</I>&gt;<i> We are using the uctimsclient and the OpenIC_Lite Client to test, and we
</I>&gt;<i> have a presence service(the openser presence serive) integrated with the
</I>&gt;<i> core.
</I>&gt;<i> Now we want test more services.
</I>&gt;<i> What services do you have integrated with the core??
</I>&gt;<i> Do you know other posibilities like the presence server of the Openser
</I>&gt;<i> with good integration with the core??
</I>&gt;<i>
</I>&gt;<i> Thanks in advance.
</I>&gt;<i>
</I>&gt;<i> Nacho
</I>&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Hi,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> You're right, the value of Service-Route header in 200 OK for REGISTER
</I>&gt;&gt;<i> should be in the INVITE message as a Route header.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> PA
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i> OpenIMSCore-Users mailing list
</I>&gt;&gt;<i> <A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">OpenIMSCore-Users at lists.berlios.de</A>
</I>&gt;&gt;<i> <A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">https://lists.berlios.de/mailman/listinfo/openimscore-users</A>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> ------------------------------
</I>&gt;<i>
</I>&gt;<i> Message: 4
</I>&gt;<i> Date: Thu, 14 Jun 2007 18:15:46 +0200
</I>&gt;<i> From: Dragos Vingarzan &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">vingarzan at fokus.fraunhofer.de</A>&gt;
</I>&gt;<i> Subject: Re: [OpenIMSCore-Users] Problem during re-registration : 401
</I>&gt;<i> response ?
</I>&gt;<i> To: JF &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">jfkavaka at gmail.com</A>&gt;
</I>&gt;<i> Cc: <A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">openimscore-users at lists.berlios.de</A>
</I>&gt;<i> Message-ID: &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">467169B2.4090807 at fokus.fraunhofer.de</A>&gt;
</I>&gt;<i> Content-Type: text/plain; charset=ISO-8859-1
</I>&gt;<i>
</I>&gt;<i> I agree, but it must be coupled with code to drop the MD5 authentication
</I>&gt;<i> vectors sometime or you'll have a memory leak.... when is that time right?
</I>&gt;<i>
</I>&gt;<i> -Dragos
</I>&gt;<i>
</I>&gt;<i> JF wrote:
</I>&gt;&gt;<i> Hi all,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I was testing with a SIP-enabled DSL router that sends in the
</I>&gt;&gt;<i> de-REGISTER the same MD5 Authorization header sent previously in the
</I>&gt;&gt;<i> REGISTER.
</I>&gt;&gt;<i> With the current behaviour the de-REGISTRATION doesn't succeed because
</I>&gt;&gt;<i> the REGISTER (with Expires=0) is challenged but this client does not
</I>&gt;&gt;<i> support responding to challenges in de-REGISTERs...
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I was able to solve it by modifying
</I>&gt;&gt;<i> scscf/registration.c::S_is_authorized():
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> if (response16.len==expected_len &amp;&amp;
</I>&gt;&gt;<i> strncasecmp(response16.s,expected,response16.len)==0){
</I>&gt;&gt;<i>                if (av-&gt;type==AUTH_AKAV1_MD5 ||
</I>&gt;&gt;<i> av-&gt;type==AUTH_AKAV2_MD5)  // ADDED BECAUSE SOME CLIENTS SEND
</I>&gt;&gt;<i> Authorization header with the same MD5 response in de-registers and
</I>&gt;&gt;<i> re-registers with no Gm security
</I>&gt;&gt;<i>                        av-&gt;status = AUTH_VECTOR_USELESS;
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I understand that invalidating the auth vectors making them one-time
</I>&gt;&gt;<i> usable brings improved security for MD5, but do you agree with having
</I>&gt;&gt;<i> a configurable flag for choosing whether the auth vector can be reused
</I>&gt;&gt;<i> for MD5? I can send the patch.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Thanks,
</I>&gt;&gt;<i> JF
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> On 6/11/07, Dragos Vingarzan &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">vingarzan at fokus.fraunhofer.de</A>&gt; wrote:
</I>&gt;&gt;&gt;<i> Hello Frederic,
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Well, because authentication vectors are treated int he same way. In the
</I>&gt;&gt;&gt;<i> end it is hard to please everyone in all the specs 3GPP, TISPAN,
</I>&gt;&gt;&gt;<i> PacketCable or IETF on the same platform. So we took the approach of
</I>&gt;&gt;&gt;<i> invalidating the vectors after one usage.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> In general, by re-registration in IMS I understand a REGISTER sent over
</I>&gt;&gt;&gt;<i> a secure connection - because converged security is one the main IMS
</I>&gt;&gt;&gt;<i> features, right? Then if re-registration happens over a secure channel
</I>&gt;&gt;&gt;<i> it won't be challenged/authenticated so anyway there is no need for
</I>&gt;&gt;&gt;<i> keeping the authentication vectors valid and reusing them. If you are
</I>&gt;&gt;&gt;<i> not using any kind of security for the Gm interface then I think that
</I>&gt;&gt;&gt;<i> you are missing most of the IMS value and you are outside the current
</I>&gt;&gt;&gt;<i> target of the Open IMS Core.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> For Gm security we now have IPSec. There is also a functional TLS branch
</I>&gt;&gt;&gt;<i> that we will try to merge very soon in the trunk.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Cheers,
</I>&gt;&gt;&gt;<i> -Dragos
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Babon Frederic wrote:
</I>&gt;&gt;&gt;<i> &gt; Thanks for your explanation !
</I>&gt;&gt;&gt;<i> &gt;
</I>&gt;&gt;&gt;<i> &gt; In my case, I am using MD5 and you said that one-time vectors does
</I>&gt;&gt;&gt;<i> not apply to MD5, so why my authentication vector is no longer valid
</I>&gt;&gt;&gt;<i> when I try to re-register?
</I>&gt;&gt;&gt;<i> &gt;
</I>&gt;&gt;&gt;<i> &gt; Frederic.
</I>&gt;&gt;&gt;<i> &gt;
</I>&gt;&gt;&gt;<i> &gt;
</I>&gt;&gt;&gt;<i> &gt;
</I>&gt;&gt;&gt;<i> &gt; -----Message d'origine-----
</I>&gt;&gt;&gt;<i> &gt; De : Dragos Vingarzan [mailto:<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">vingarzan at fokus.fraunhofer.de</A>]
</I>&gt;&gt;&gt;<i> &gt; Envoy? : lundi 4 juin 2007 11:16
</I>&gt;&gt;&gt;<i> &gt; ? : Verbeiren, David
</I>&gt;&gt;&gt;<i> &gt; Cc : Babon Frederic; <A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">openimscore-users at lists.berlios.de</A>
</I>&gt;&gt;&gt;<i> &gt; Objet : Re: [OpenIMSCore-Users] Problem during re-registration :
</I>&gt;&gt;&gt;<i> 401 response ?
</I>&gt;&gt;&gt;<i> &gt;
</I>&gt;&gt;&gt;<i> &gt; Hi David,
</I>&gt;&gt;&gt;<i> &gt;
</I>&gt;&gt;&gt;<i> &gt; You are right. The authentication vectors are treated as one-time
</I>&gt;&gt;&gt;<i> valid
</I>&gt;&gt;&gt;<i> &gt; ones. This means that each authentication vector can be used exactly
</I>&gt;&gt;&gt;<i> &gt; once to test a response for correctness (irrespective if it is correct
</I>&gt;&gt;&gt;<i> &gt; or not). This is a must for AKA. I have seen that it is not for
</I>&gt;&gt;&gt;<i> MD5, but
</I>&gt;&gt;&gt;<i> &gt; I think that the extra security that this one-time usage brings is
</I>&gt;&gt;&gt;<i> worth
</I>&gt;&gt;&gt;<i> &gt; the effort of creating new authentication vectors (plus that the
</I>&gt;&gt;&gt;<i> S-CSCF
</I>&gt;&gt;&gt;<i> &gt; can request more than 1 auth vector at a time).
</I>&gt;&gt;&gt;<i> &gt;
</I>&gt;&gt;&gt;<i> &gt; So then re-registration is simpler and quicker only if the client
</I>&gt;&gt;&gt;<i> uses a
</I>&gt;&gt;&gt;<i> &gt; IPSec or TLS security mechanism with the P-CSCF so that the
</I>&gt;&gt;&gt;<i> security of
</I>&gt;&gt;&gt;<i> &gt; the REGISTER message is granted. Then an integrity-protected=yes value
</I>&gt;&gt;&gt;<i> &gt; will be present in the Authorization header and the S-CSCF won't
</I>&gt;&gt;&gt;<i> &gt; challenge it.
</I>&gt;&gt;&gt;<i> &gt;
</I>&gt;&gt;&gt;<i> &gt; About compatibility, I think that any client should be ready to act at
</I>&gt;&gt;&gt;<i> &gt; any time to 401/407 responses.
</I>&gt;&gt;&gt;<i> &gt;
</I>&gt;&gt;&gt;<i> &gt; -Dragos
</I>&gt;&gt;&gt;<i> &gt;
</I>&gt;&gt;&gt;<i> &gt;
</I>&gt;&gt;&gt;<i> &gt; Verbeiren, David wrote:
</I>&gt;&gt;&gt;<i> &gt;
</I>&gt;&gt;&gt;<i> &gt;&gt; Hi Frederic,
</I>&gt;&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;&gt;<i> &gt;&gt; Based on the behavior I've seen from the CSCFs (i.e. not based on
</I>&gt;&gt;&gt;<i> code walkthrough), I think the log message means that the auth vector
</I>&gt;&gt;&gt;<i> that the CSCF got from the HSS during initial registration has been
</I>&gt;&gt;&gt;<i> removed from a local cache somehow and that, upon receiving 401, your
</I>&gt;&gt;&gt;<i> UE has to respond to the new challenge (i.e. new REGISTER with
</I>&gt;&gt;&gt;<i> response to the new challenge). And I don't think - again only based
</I>&gt;&gt;&gt;<i> on observed behavior so far -, that the time an auth vector remains
</I>&gt;&gt;&gt;<i> in the cache is related in any way to the registration expiry time
</I>&gt;&gt;&gt;<i> negotiated during initial registration.
</I>&gt;&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;&gt;<i> &gt;&gt; Also, I do not know whether this behavior is correct or not. It
</I>&gt;&gt;&gt;<i> seems a bit odd because it makes the re-registration really behave as
</I>&gt;&gt;&gt;<i> a fresh registration as soon as the auth vector is not in the cache
</I>&gt;&gt;&gt;<i> anymore...
</I>&gt;&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;&gt;<i> &gt;&gt; Just my 2c.
</I>&gt;&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;&gt;<i> &gt;&gt; -David
</I>&gt;&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;&gt;<i> &gt;&gt; ________________________________________
</I>&gt;&gt;&gt;<i> &gt;&gt; From: <A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">openimscore-users-bounces at lists.berlios.de</A>
</I>&gt;&gt;&gt;<i> [mailto:<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">openimscore-users-bounces at lists.berlios.de</A>] On Behalf Of
</I>&gt;&gt;&gt;<i> Babon Frederic
</I>&gt;&gt;&gt;<i> &gt;&gt; Sent: 01 June 2007 18:35
</I>&gt;&gt;&gt;<i> &gt;&gt; To: <A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">openimscore-users at lists.berlios.de</A>
</I>&gt;&gt;&gt;<i> &gt;&gt; Subject: [OpenIMSCore-Users] Problem during re-registration : 401
</I>&gt;&gt;&gt;<i> response ?
</I>&gt;&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;&gt;<i> &gt;&gt; Hello,
</I>&gt;&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;&gt;<i> &gt;&gt; I have a problem when i try to do a re-registration: the server
</I>&gt;&gt;&gt;<i> reply by a 401 unauthorized sip message.
</I>&gt;&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;&gt;<i> &gt;&gt; If I take a look at the CSCF trace log I can see: no matching auth
</I>&gt;&gt;&gt;<i> vector found - maybe timer expired
</I>&gt;&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;&gt;<i> &gt;&gt; Is that mean that I have to send my re-registration message one
</I>&gt;&gt;&gt;<i> second before registration timeout or something like this?
</I>&gt;&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;&gt;<i> &gt;&gt; The CSCF should wait a little more before disabling registration?
</I>&gt;&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;&gt;<i> &gt;&gt; This is the corresponding ethereal trace:
</I>&gt;&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;&gt;<i> &gt;&gt; REQUEST
</I>&gt;&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;&gt;<i> &gt;&gt; Frame 119 (707 bytes on wire, 707 bytes captured)
</I>&gt;&gt;&gt;<i> &gt;&gt; Ethernet II, Src: 00:11:25:55:22:e8, Dst: 00:0c:29:3d:20:09
</I>&gt;&gt;&gt;<i> &gt;&gt; Internet Protocol, Src Addr: 178.3.3.57 (178.3.3.57), Dst Addr:
</I>&gt;&gt;&gt;<i> 178.3.3.30 (178.3.3.30)
</I>&gt;&gt;&gt;<i> &gt;&gt; User Datagram Protocol, Src Port: 5070 (5070), Dst Port: 5060 (5060)
</I>&gt;&gt;&gt;<i> &gt;&gt; Session Initiation Protocol
</I>&gt;&gt;&gt;<i> &gt;&gt;     Request-Line: REGISTER sip:test.net SIP/2.0
</I>&gt;&gt;&gt;<i> &gt;&gt;         Method: REGISTER
</I>&gt;&gt;&gt;<i> &gt;&gt;     Message Header
</I>&gt;&gt;&gt;<i> &gt;&gt;         Via: SIP/2.0/UDP
</I>&gt;&gt;&gt;<i> 178.3.3.57:5070;rport;branch=z9hG4bKPj8bba4284637b40fb8b89684b9b95f2cb
</I>&gt;&gt;&gt;<i> &gt;&gt;         Route: &lt;sip:pcscf.test.net:5060;lr&gt;
</I>&gt;&gt;&gt;<i> &gt;&gt;         Max-Forwards: 70
</I>&gt;&gt;&gt;<i> &gt;&gt;         From:
</I>&gt;&gt;&gt;<i> &lt;sip:<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">fbabon at test.net</A>&gt;;tag=4985f8994a1b43f4b9612976af86df94
</I>&gt;&gt;&gt;<i> &gt;&gt;         To: &lt;sip:<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">fbabon at test.net</A>&gt;
</I>&gt;&gt;&gt;<i> &gt;&gt;         Call-ID: c7936cc9979e4523b293fd17bf47f3c1
</I>&gt;&gt;&gt;<i> &gt;&gt;         CSeq: 41426 REGISTER
</I>&gt;&gt;&gt;<i> &gt;&gt;         User-Agent: SmartBox
</I>&gt;&gt;&gt;<i> &gt;&gt;         Contact: &lt;sip:<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">fbabon at 178.3.3.57</A>:5070;transport=UDP&gt;
</I>&gt;&gt;&gt;<i> &gt;&gt;         Expires: 30
</I>&gt;&gt;&gt;<i> &gt;&gt;         Authorization: Digest username=&quot;<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">fbabon_private1 at test.net</A>&quot;,
</I>&gt;&gt;&gt;<i> realm=&quot;test.net&quot;, nonce=&quot;31733e7d0be15bef21d5ee6644d67a58&quot;,
</I>&gt;&gt;&gt;<i> uri=&quot;sip:test.net&quot;, response=&quot;5a49954854b3d332b7ef98e27f88c41c&quot;,
</I>&gt;&gt;&gt;<i> algorithm=md5
</I>&gt;&gt;&gt;<i> &gt;&gt;     Message body
</I>&gt;&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;&gt;<i> &gt;&gt; RESPONSE
</I>&gt;&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;&gt;<i> &gt;&gt; Frame 120 (881 bytes on wire, 881 bytes captured)
</I>&gt;&gt;&gt;<i> &gt;&gt; Ethernet II, Src: 00:0c:29:3d:20:09, Dst: 00:11:25:55:22:e8
</I>&gt;&gt;&gt;<i> &gt;&gt; Internet Protocol, Src Addr: 178.3.3.30 (178.3.3.30), Dst Addr:
</I>&gt;&gt;&gt;<i> 178.3.3.57 (178.3.3.57)
</I>&gt;&gt;&gt;<i> &gt;&gt; User Datagram Protocol, Src Port: 5060 (5060), Dst Port: 5070 (5070)
</I>&gt;&gt;&gt;<i> &gt;&gt; Session Initiation Protocol
</I>&gt;&gt;&gt;<i> &gt;&gt;     Status-Line: SIP/2.0 401 Unauthorized - Challenging the UE
</I>&gt;&gt;&gt;<i> &gt;&gt;         Status-Code: 401
</I>&gt;&gt;&gt;<i> &gt;&gt;     Message Header
</I>&gt;&gt;&gt;<i> &gt;&gt;         Via: SIP/2.0/UDP
</I>&gt;&gt;&gt;<i> 178.3.3.57:5070;received=178.3.3.57;rport=5070;branch=z9hG4bKPj8bba4284637b40fb8b89684b9b95f2cb
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> &gt;&gt;         From:
</I>&gt;&gt;&gt;<i> &lt;sip:<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">fbabon at test.net</A>&gt;;tag=4985f8994a1b43f4b9612976af86df94
</I>&gt;&gt;&gt;<i> &gt;&gt;         To:
</I>&gt;&gt;&gt;<i> &lt;sip:<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">fbabon at test.net</A>&gt;;tag=52d5f3a3b88eb39fcd217d749091994e-c85e
</I>&gt;&gt;&gt;<i> &gt;&gt;         Call-ID: c7936cc9979e4523b293fd17bf47f3c1
</I>&gt;&gt;&gt;<i> &gt;&gt;         CSeq: 41426 REGISTER
</I>&gt;&gt;&gt;<i> &gt;&gt;         Path: &lt;sip:<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">term at pcscf.test.net</A>:5060;lr&gt;
</I>&gt;&gt;&gt;<i> &gt;&gt;         Service-Route: &lt;sip:<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">orig at scscf.test.net</A>:6060;lr&gt;
</I>&gt;&gt;&gt;<i> &gt;&gt;         Server: Sip EXpress router (2.1.0-dev1 OpenIMSCore
</I>&gt;&gt;&gt;<i> (i386/linux))
</I>&gt;&gt;&gt;<i> &gt;&gt;         Content-Length: 0
</I>&gt;&gt;&gt;<i> &gt;&gt;         Warning: 392 178.3.3.30:6060 &quot;Noisy feedback tells:
</I>&gt;&gt;&gt;<i> pid=1072 req_src_ip=178.3.3.30 req_src_port=4060
</I>&gt;&gt;&gt;<i> in_uri=sip:scscf.test.net:6060 out_uri=sip:scscf.test.net:6060
</I>&gt;&gt;&gt;<i> via_cnt==3&quot;
</I>&gt;&gt;&gt;<i> &gt;&gt;         WWW-Authenticate: Digest realm=&quot;test.net&quot;,
</I>&gt;&gt;&gt;<i> nonce=&quot;e8445d47dd69542ad7ba6fb3ba195cac&quot;, algorithm=MD5
</I>&gt;&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;&gt;<i> &gt;&gt; Thanks a lot for your help.
</I>&gt;&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;&gt;<i> &gt;&gt; Frederic Babon
</I>&gt;&gt;&gt;<i> &gt;&gt; _______________________________________________
</I>&gt;&gt;&gt;<i> &gt;&gt; OpenIMSCore-Users mailing list
</I>&gt;&gt;&gt;<i> &gt;&gt; <A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">OpenIMSCore-Users at lists.berlios.de</A>
</I>&gt;&gt;&gt;<i> &gt;&gt; <A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">https://lists.berlios.de/mailman/listinfo/openimscore-users</A>
</I>&gt;&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;&gt;<i> &gt;
</I>&gt;&gt;&gt;<i> &gt;
</I>&gt;&gt;&gt;<i> &gt;
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> -- 
</I>&gt;&gt;&gt;<i> -----------------------------------------
</I>&gt;&gt;&gt;<i> Dipl. Eng. Dragos Vingarzan
</I>&gt;&gt;&gt;<i> Fraunhofer FOKUS/NGNI
</I>&gt;&gt;&gt;<i> Kaiserin-Augusta-Allee 31
</I>&gt;&gt;&gt;<i> 10589 Berlin,Germany
</I>&gt;&gt;&gt;<i> Phone +49 (0)30 - 3463 - 7385
</I>&gt;&gt;&gt;<i> Mobile +49 (0)163 - 159 - 5221
</I>&gt;&gt;&gt;<i> Web www.fokus.fraunhofer.de www.openimscore.org
</I>&gt;&gt;&gt;<i> We could change the world if God would give us the source code...
</I>&gt;&gt;&gt;<i> -----------------------------------------------------------------
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;&gt;<i> OpenIMSCore-Users mailing list
</I>&gt;&gt;&gt;<i> <A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">OpenIMSCore-Users at lists.berlios.de</A>
</I>&gt;&gt;&gt;<i> <A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">https://lists.berlios.de/mailman/listinfo/openimscore-users</A>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> -- 
</I>&gt;<i> -----------------------------------------
</I>&gt;<i> Dipl. Eng. Dragos Vingarzan
</I>&gt;<i> Fraunhofer FOKUS/NGNI
</I>&gt;<i> Kaiserin-Augusta-Allee 31
</I>&gt;<i> 10589 Berlin,Germany
</I>&gt;<i> Phone +49 (0)30 - 3463 - 7385
</I>&gt;<i> Mobile +49 (0)163 - 159 - 5221
</I>&gt;<i> Web www.fokus.fraunhofer.de www.openimscore.org
</I>&gt;<i> We could change the world if God would give us the source code...
</I>&gt;<i> -----------------------------------------------------------------
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> ------------------------------
</I>&gt;<i>
</I>&gt;<i> Message: 5
</I>&gt;<i> Date: Thu, 14 Jun 2007 17:19:19 +0100
</I>&gt;<i> From: JF &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">jfkavaka at gmail.com</A>&gt;
</I>&gt;<i> Subject: Re: [OpenIMSCore-Users] Problem during re-registration : 401
</I>&gt;<i> response ?
</I>&gt;<i> To: &quot;Dragos Vingarzan&quot; &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">vingarzan at fokus.fraunhofer.de</A>&gt;
</I>&gt;<i> Cc: <A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">openimscore-users at lists.berlios.de</A>
</I>&gt;<i> Message-ID:
</I>&gt;<i> &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">b33002040706140919l4a2bfec2xb134057435a7d96e at mail.gmail.com</A>&gt;
</I>&gt;<i> Content-Type: text/plain; charset=ISO-8859-1; format=flowed
</I>&gt;<i>
</I>&gt;<i> I would say after de-registration or registration timeout.
</I>&gt;<i>
</I>&gt;<i> JF
</I>&gt;<i>
</I>&gt;<i> On 6/14/07, Dragos Vingarzan &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">vingarzan at fokus.fraunhofer.de</A>&gt; wrote:
</I>&gt;&gt;<i> I agree, but it must be coupled with code to drop the MD5 authentication
</I>&gt;&gt;<i> vectors sometime or you'll have a memory leak.... when is that time 
</I>&gt;&gt;<i> right?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> -Dragos
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> JF wrote:
</I>&gt;&gt;<i> &gt; Hi all,
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; I was testing with a SIP-enabled DSL router that sends in the
</I>&gt;&gt;<i> &gt; de-REGISTER the same MD5 Authorization header sent previously in the
</I>&gt;&gt;<i> &gt; REGISTER.
</I>&gt;&gt;<i> &gt; With the current behaviour the de-REGISTRATION doesn't succeed because
</I>&gt;&gt;<i> &gt; the REGISTER (with Expires=0) is challenged but this client does not
</I>&gt;&gt;<i> &gt; support responding to challenges in de-REGISTERs...
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; I was able to solve it by modifying
</I>&gt;&gt;<i> &gt; scscf/registration.c::S_is_authorized():
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; if (response16.len==expected_len &amp;&amp;
</I>&gt;&gt;<i> &gt; strncasecmp(response16.s,expected,response16.len)==0){
</I>&gt;&gt;<i> &gt;                if (av-&gt;type==AUTH_AKAV1_MD5 ||
</I>&gt;&gt;<i> &gt; av-&gt;type==AUTH_AKAV2_MD5)  // ADDED BECAUSE SOME CLIENTS SEND
</I>&gt;&gt;<i> &gt; Authorization header with the same MD5 response in de-registers and
</I>&gt;&gt;<i> &gt; re-registers with no Gm security
</I>&gt;&gt;<i> &gt;                        av-&gt;status = AUTH_VECTOR_USELESS;
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; I understand that invalidating the auth vectors making them one-time
</I>&gt;&gt;<i> &gt; usable brings improved security for MD5, but do you agree with having
</I>&gt;&gt;<i> &gt; a configurable flag for choosing whether the auth vector can be reused
</I>&gt;&gt;<i> &gt; for MD5? I can send the patch.
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; Thanks,
</I>&gt;&gt;<i> &gt; JF
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; On 6/11/07, Dragos Vingarzan &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">vingarzan at fokus.fraunhofer.de</A>&gt; wrote:
</I>&gt;&gt;<i> &gt;&gt; Hello Frederic,
</I>&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt; Well, because authentication vectors are treated int he same way. In 
</I>&gt;&gt;<i> &gt;&gt; the
</I>&gt;&gt;<i> &gt;&gt; end it is hard to please everyone in all the specs 3GPP, TISPAN,
</I>&gt;&gt;<i> &gt;&gt; PacketCable or IETF on the same platform. So we took the approach of
</I>&gt;&gt;<i> &gt;&gt; invalidating the vectors after one usage.
</I>&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt; In general, by re-registration in IMS I understand a REGISTER sent 
</I>&gt;&gt;<i> &gt;&gt; over
</I>&gt;&gt;<i> &gt;&gt; a secure connection - because converged security is one the main IMS
</I>&gt;&gt;<i> &gt;&gt; features, right? Then if re-registration happens over a secure channel
</I>&gt;&gt;<i> &gt;&gt; it won't be challenged/authenticated so anyway there is no need for
</I>&gt;&gt;<i> &gt;&gt; keeping the authentication vectors valid and reusing them. If you are
</I>&gt;&gt;<i> &gt;&gt; not using any kind of security for the Gm interface then I think that
</I>&gt;&gt;<i> &gt;&gt; you are missing most of the IMS value and you are outside the current
</I>&gt;&gt;<i> &gt;&gt; target of the Open IMS Core.
</I>&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt; For Gm security we now have IPSec. There is also a functional TLS 
</I>&gt;&gt;<i> &gt;&gt; branch
</I>&gt;&gt;<i> &gt;&gt; that we will try to merge very soon in the trunk.
</I>&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt; Cheers,
</I>&gt;&gt;<i> &gt;&gt; -Dragos
</I>&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt; Babon Frederic wrote:
</I>&gt;&gt;<i> &gt;&gt; &gt; Thanks for your explanation !
</I>&gt;&gt;<i> &gt;&gt; &gt;
</I>&gt;&gt;<i> &gt;&gt; &gt; In my case, I am using MD5 and you said that one-time vectors does
</I>&gt;&gt;<i> &gt;&gt; not apply to MD5, so why my authentication vector is no longer valid
</I>&gt;&gt;<i> &gt;&gt; when I try to re-register?
</I>&gt;&gt;<i> &gt;&gt; &gt;
</I>&gt;&gt;<i> &gt;&gt; &gt; Frederic.
</I>&gt;&gt;<i> &gt;&gt; &gt;
</I>&gt;&gt;<i> &gt;&gt; &gt;
</I>&gt;&gt;<i> &gt;&gt; &gt;
</I>&gt;&gt;<i> &gt;&gt; &gt; -----Message d'origine-----
</I>&gt;&gt;<i> &gt;&gt; &gt; De : Dragos Vingarzan [mailto:<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">vingarzan at fokus.fraunhofer.de</A>]
</I>&gt;&gt;<i> &gt;&gt; &gt; Envoy? : lundi 4 juin 2007 11:16
</I>&gt;&gt;<i> &gt;&gt; &gt; ? : Verbeiren, David
</I>&gt;&gt;<i> &gt;&gt; &gt; Cc : Babon Frederic; <A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">openimscore-users at lists.berlios.de</A>
</I>&gt;&gt;<i> &gt;&gt; &gt; Objet : Re: [OpenIMSCore-Users] Problem during re-registration :
</I>&gt;&gt;<i> &gt;&gt; 401 response ?
</I>&gt;&gt;<i> &gt;&gt; &gt;
</I>&gt;&gt;<i> &gt;&gt; &gt; Hi David,
</I>&gt;&gt;<i> &gt;&gt; &gt;
</I>&gt;&gt;<i> &gt;&gt; &gt; You are right. The authentication vectors are treated as one-time
</I>&gt;&gt;<i> &gt;&gt; valid
</I>&gt;&gt;<i> &gt;&gt; &gt; ones. This means that each authentication vector can be used exactly
</I>&gt;&gt;<i> &gt;&gt; &gt; once to test a response for correctness (irrespective if it is 
</I>&gt;&gt;<i> &gt;&gt; &gt; correct
</I>&gt;&gt;<i> &gt;&gt; &gt; or not). This is a must for AKA. I have seen that it is not for
</I>&gt;&gt;<i> &gt;&gt; MD5, but
</I>&gt;&gt;<i> &gt;&gt; &gt; I think that the extra security that this one-time usage brings is
</I>&gt;&gt;<i> &gt;&gt; worth
</I>&gt;&gt;<i> &gt;&gt; &gt; the effort of creating new authentication vectors (plus that the
</I>&gt;&gt;<i> &gt;&gt; S-CSCF
</I>&gt;&gt;<i> &gt;&gt; &gt; can request more than 1 auth vector at a time).
</I>&gt;&gt;<i> &gt;&gt; &gt;
</I>&gt;&gt;<i> &gt;&gt; &gt; So then re-registration is simpler and quicker only if the client
</I>&gt;&gt;<i> &gt;&gt; uses a
</I>&gt;&gt;<i> &gt;&gt; &gt; IPSec or TLS security mechanism with the P-CSCF so that the
</I>&gt;&gt;<i> &gt;&gt; security of
</I>&gt;&gt;<i> &gt;&gt; &gt; the REGISTER message is granted. Then an integrity-protected=yes 
</I>&gt;&gt;<i> &gt;&gt; &gt; value
</I>&gt;&gt;<i> &gt;&gt; &gt; will be present in the Authorization header and the S-CSCF won't
</I>&gt;&gt;<i> &gt;&gt; &gt; challenge it.
</I>&gt;&gt;<i> &gt;&gt; &gt;
</I>&gt;&gt;<i> &gt;&gt; &gt; About compatibility, I think that any client should be ready to act 
</I>&gt;&gt;<i> &gt;&gt; &gt; at
</I>&gt;&gt;<i> &gt;&gt; &gt; any time to 401/407 responses.
</I>&gt;&gt;<i> &gt;&gt; &gt;
</I>&gt;&gt;<i> &gt;&gt; &gt; -Dragos
</I>&gt;&gt;<i> &gt;&gt; &gt;
</I>&gt;&gt;<i> &gt;&gt; &gt;
</I>&gt;&gt;<i> &gt;&gt; &gt; Verbeiren, David wrote:
</I>&gt;&gt;<i> &gt;&gt; &gt;
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt; Hi Frederic,
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt; Based on the behavior I've seen from the CSCFs (i.e. not based on
</I>&gt;&gt;<i> &gt;&gt; code walkthrough), I think the log message means that the auth vector
</I>&gt;&gt;<i> &gt;&gt; that the CSCF got from the HSS during initial registration has been
</I>&gt;&gt;<i> &gt;&gt; removed from a local cache somehow and that, upon receiving 401, your
</I>&gt;&gt;<i> &gt;&gt; UE has to respond to the new challenge (i.e. new REGISTER with
</I>&gt;&gt;<i> &gt;&gt; response to the new challenge). And I don't think - again only based
</I>&gt;&gt;<i> &gt;&gt; on observed behavior so far -, that the time an auth vector remains
</I>&gt;&gt;<i> &gt;&gt; in the cache is related in any way to the registration expiry time
</I>&gt;&gt;<i> &gt;&gt; negotiated during initial registration.
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt; Also, I do not know whether this behavior is correct or not. It
</I>&gt;&gt;<i> &gt;&gt; seems a bit odd because it makes the re-registration really behave as
</I>&gt;&gt;<i> &gt;&gt; a fresh registration as soon as the auth vector is not in the cache
</I>&gt;&gt;<i> &gt;&gt; anymore...
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt; Just my 2c.
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt; -David
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt; ________________________________________
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt; From: <A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">openimscore-users-bounces at lists.berlios.de</A>
</I>&gt;&gt;<i> &gt;&gt; [mailto:<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">openimscore-users-bounces at lists.berlios.de</A>] On Behalf Of
</I>&gt;&gt;<i> &gt;&gt; Babon Frederic
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt; Sent: 01 June 2007 18:35
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt; To: <A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">openimscore-users at lists.berlios.de</A>
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt; Subject: [OpenIMSCore-Users] Problem during re-registration : 401
</I>&gt;&gt;<i> &gt;&gt; response ?
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt; Hello,
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt; I have a problem when i try to do a re-registration: the server
</I>&gt;&gt;<i> &gt;&gt; reply by a 401 unauthorized sip message.
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt; If I take a look at the CSCF trace log I can see: no matching auth
</I>&gt;&gt;<i> &gt;&gt; vector found - maybe timer expired
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt; Is that mean that I have to send my re-registration message one
</I>&gt;&gt;<i> &gt;&gt; second before registration timeout or something like this?
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt; The CSCF should wait a little more before disabling registration?
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt; This is the corresponding ethereal trace:
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt; REQUEST
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt; Frame 119 (707 bytes on wire, 707 bytes captured)
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt; Ethernet II, Src: 00:11:25:55:22:e8, Dst: 00:0c:29:3d:20:09
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt; Internet Protocol, Src Addr: 178.3.3.57 (178.3.3.57), Dst Addr:
</I>&gt;&gt;<i> &gt;&gt; 178.3.3.30 (178.3.3.30)
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt; User Datagram Protocol, Src Port: 5070 (5070), Dst Port: 5060 
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt; (5060)
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt; Session Initiation Protocol
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt;     Request-Line: REGISTER sip:test.net SIP/2.0
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt;         Method: REGISTER
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt;     Message Header
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt;         Via: SIP/2.0/UDP
</I>&gt;&gt;<i> &gt;&gt; 178.3.3.57:5070;rport;branch=z9hG4bKPj8bba4284637b40fb8b89684b9b95f2cb
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt;         Route: &lt;sip:pcscf.test.net:5060;lr&gt;
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt;         Max-Forwards: 70
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt;         From:
</I>&gt;&gt;<i> &gt;&gt; &lt;sip:<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">fbabon at test.net</A>&gt;;tag=4985f8994a1b43f4b9612976af86df94
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt;         To: &lt;sip:<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">fbabon at test.net</A>&gt;
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt;         Call-ID: c7936cc9979e4523b293fd17bf47f3c1
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt;         CSeq: 41426 REGISTER
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt;         User-Agent: SmartBox
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt;         Contact: &lt;sip:<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">fbabon at 178.3.3.57</A>:5070;transport=UDP&gt;
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt;         Expires: 30
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt;         Authorization: Digest username=&quot;<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">fbabon_private1 at test.net</A>&quot;,
</I>&gt;&gt;<i> &gt;&gt; realm=&quot;test.net&quot;, nonce=&quot;31733e7d0be15bef21d5ee6644d67a58&quot;,
</I>&gt;&gt;<i> &gt;&gt; uri=&quot;sip:test.net&quot;, response=&quot;5a49954854b3d332b7ef98e27f88c41c&quot;,
</I>&gt;&gt;<i> &gt;&gt; algorithm=md5
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt;     Message body
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt; RESPONSE
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt; Frame 120 (881 bytes on wire, 881 bytes captured)
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt; Ethernet II, Src: 00:0c:29:3d:20:09, Dst: 00:11:25:55:22:e8
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt; Internet Protocol, Src Addr: 178.3.3.30 (178.3.3.30), Dst Addr:
</I>&gt;&gt;<i> &gt;&gt; 178.3.3.57 (178.3.3.57)
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt; User Datagram Protocol, Src Port: 5060 (5060), Dst Port: 5070 
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt; (5070)
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt; Session Initiation Protocol
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt;     Status-Line: SIP/2.0 401 Unauthorized - Challenging the UE
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt;         Status-Code: 401
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt;     Message Header
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt;         Via: SIP/2.0/UDP
</I>&gt;&gt;<i> &gt;&gt; 178.3.3.57:5070;received=178.3.3.57;rport=5070;branch=z9hG4bKPj8bba4284637b40fb8b89684b9b95f2cb
</I>&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt;         From:
</I>&gt;&gt;<i> &gt;&gt; &lt;sip:<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">fbabon at test.net</A>&gt;;tag=4985f8994a1b43f4b9612976af86df94
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt;         To:
</I>&gt;&gt;<i> &gt;&gt; &lt;sip:<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">fbabon at test.net</A>&gt;;tag=52d5f3a3b88eb39fcd217d749091994e-c85e
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt;         Call-ID: c7936cc9979e4523b293fd17bf47f3c1
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt;         CSeq: 41426 REGISTER
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt;         Path: &lt;sip:<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">term at pcscf.test.net</A>:5060;lr&gt;
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt;         Service-Route: &lt;sip:<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">orig at scscf.test.net</A>:6060;lr&gt;
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt;         Server: Sip EXpress router (2.1.0-dev1 OpenIMSCore
</I>&gt;&gt;<i> &gt;&gt; (i386/linux))
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt;         Content-Length: 0
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt;         Warning: 392 178.3.3.30:6060 &quot;Noisy feedback tells:
</I>&gt;&gt;<i> &gt;&gt; pid=1072 req_src_ip=178.3.3.30 req_src_port=4060
</I>&gt;&gt;<i> &gt;&gt; in_uri=sip:scscf.test.net:6060 out_uri=sip:scscf.test.net:6060
</I>&gt;&gt;<i> &gt;&gt; via_cnt==3&quot;
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt;         WWW-Authenticate: Digest realm=&quot;test.net&quot;,
</I>&gt;&gt;<i> &gt;&gt; nonce=&quot;e8445d47dd69542ad7ba6fb3ba195cac&quot;, algorithm=MD5
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt; Thanks a lot for your help.
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt; Frederic Babon
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt; _______________________________________________
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt; OpenIMSCore-Users mailing list
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt; <A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">OpenIMSCore-Users at lists.berlios.de</A>
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt; <A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">https://lists.berlios.de/mailman/listinfo/openimscore-users</A>
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt; &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt; &gt;
</I>&gt;&gt;<i> &gt;&gt; &gt;
</I>&gt;&gt;<i> &gt;&gt; &gt;
</I>&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt; --
</I>&gt;&gt;<i> &gt;&gt; -----------------------------------------
</I>&gt;&gt;<i> &gt;&gt; Dipl. Eng. Dragos Vingarzan
</I>&gt;&gt;<i> &gt;&gt; Fraunhofer FOKUS/NGNI
</I>&gt;&gt;<i> &gt;&gt; Kaiserin-Augusta-Allee 31
</I>&gt;&gt;<i> &gt;&gt; 10589 Berlin,Germany
</I>&gt;&gt;<i> &gt;&gt; Phone +49 (0)30 - 3463 - 7385
</I>&gt;&gt;<i> &gt;&gt; Mobile +49 (0)163 - 159 - 5221
</I>&gt;&gt;<i> &gt;&gt; Web www.fokus.fraunhofer.de www.openimscore.org
</I>&gt;&gt;<i> &gt;&gt; We could change the world if God would give us the source code...
</I>&gt;&gt;<i> &gt;&gt; -----------------------------------------------------------------
</I>&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;<i> &gt;&gt; _______________________________________________
</I>&gt;&gt;<i> &gt;&gt; OpenIMSCore-Users mailing list
</I>&gt;&gt;<i> &gt;&gt; <A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">OpenIMSCore-Users at lists.berlios.de</A>
</I>&gt;&gt;<i> &gt;&gt; <A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">https://lists.berlios.de/mailman/listinfo/openimscore-users</A>
</I>&gt;&gt;<i> &gt;&gt;
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> --
</I>&gt;&gt;<i> -----------------------------------------
</I>&gt;&gt;<i> Dipl. Eng. Dragos Vingarzan
</I>&gt;&gt;<i> Fraunhofer FOKUS/NGNI
</I>&gt;&gt;<i> Kaiserin-Augusta-Allee 31
</I>&gt;&gt;<i> 10589 Berlin,Germany
</I>&gt;&gt;<i> Phone +49 (0)30 - 3463 - 7385
</I>&gt;&gt;<i> Mobile +49 (0)163 - 159 - 5221
</I>&gt;&gt;<i> Web www.fokus.fraunhofer.de www.openimscore.org
</I>&gt;&gt;<i> We could change the world if God would give us the source code...
</I>&gt;&gt;<i> -----------------------------------------------------------------
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> ------------------------------
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> OpenIMSCore-Users mailing list
</I>&gt;<i> <A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">OpenIMSCore-Users at lists.berlios.de</A>
</I>&gt;<i> <A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">https://lists.berlios.de/mailman/listinfo/openimscore-users</A>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> End of OpenIMSCore-Users Digest, Vol 8, Issue 21
</I>&gt;<i> ************************************************
</I>&gt;<i>
</I>&gt;<i> __________ NOD32 2085 (20070228) Information __________
</I>&gt;<i>
</I>&gt;<i> This message was checked by NOD32 antivirus system.
</I>&gt;<i> <A HREF="http://www.eset.com">http://www.eset.com</A>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> __________ NOD32 2085 (20070228) Information __________
</I>&gt;<i>
</I>&gt;<i> This message was checked by NOD32 antivirus system.
</I>&gt;<i> <A HREF="http://www.eset.com">http://www.eset.com</A>
</I>&gt;<i>
</I>&gt;<i> 
</I>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002014.html">[OpenIMSCore-Users] Query on IPSec at P-CSCF (Registeration)
</A></li>
	<LI>Next message: <A HREF="001975.html">[OpenIMSCore-Users] call flow: AS INVITE with Request-URI != URI	for our domain
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1974">[ date ]</a>
              <a href="thread.html#1974">[ thread ]</a>
              <a href="subject.html#1974">[ subject ]</a>
              <a href="author.html#1974">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/openimscore-users">More information about the OpenIMSCore-Users
mailing list</a><br>
</body></html>
