<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [OpenIMSCore-Users] Problem with sipp using ipsec towards OpenIMS
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/openimscore-users/2010-March/index.html" >
   <LINK REL="made" HREF="mailto:openimscore-users%40lists.berlios.de?Subject=Re%3A%20%5BOpenIMSCore-Users%5D%20Problem%20with%20sipp%20using%20ipsec%20towards%20OpenIMS&In-Reply-To=%3C4B8D0BEF.9040401%40ip-solutions.se%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="006111.html">
   <LINK REL="Next"  HREF="006113.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[OpenIMSCore-Users] Problem with sipp using ipsec towards OpenIMS</H1>
    <B>Kenneth L&#246;fstrand</B> 
    <A HREF="mailto:openimscore-users%40lists.berlios.de?Subject=Re%3A%20%5BOpenIMSCore-Users%5D%20Problem%20with%20sipp%20using%20ipsec%20towards%20OpenIMS&In-Reply-To=%3C4B8D0BEF.9040401%40ip-solutions.se%3E"
       TITLE="[OpenIMSCore-Users] Problem with sipp using ipsec towards OpenIMS">kenneth at ip-solutions.se
       </A><BR>
    <I>Tue Mar  2 14:00:31 CET 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="006111.html">[OpenIMSCore-Users] Address selection in P-CSCF
</A></li>
        <LI>Next message: <A HREF="006113.html">[OpenIMSCore-Users] S-CSCF error during register with DeReg	tickedin REGISTER method trigger
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6112">[ date ]</a>
              <a href="thread.html#6112">[ thread ]</a>
              <a href="subject.html#6112">[ subject ]</a>
              <a href="author.html#6112">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi
I try to use sipp and IPsec towards OpenIMS as described in the FAQ but 
it fails. The first Register is sent and a 401 is replied as expected. 
Sipp then sends another Register but that request is never forwarded by 
the P-CSCF. I have all CSCF's located in different nodes so I can 
wireshark between them all but the Register request that contains the 
Authorization information seems to be just discarded by the P-CSCF. Also 
the logging does not give me any clue to what might be the problem.

Anyone that has an idea?

Regards
Kenneth L&#246;fstrand

Mar  2 14:40:04 HSS /opt/OpenIMSCore/ser_ims/ser[3218]: 
^[[0;33;44mTracepoint: 1 REGISTER sip:ip-s-a.com from: 172.28.0.102:3061 
From: sip:<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">alice at ip-s-a.com</A> To: sip:<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">alice at ip-s-a.com</A> ^[[0;39;49m^[[0m
Mar  2 14:40:04 HSS /opt/OpenIMSCore/ser_ims/ser[3218]: 
DBG:P-CSCF:P_verify_security: Looking for &lt;1://172.28.0.102:3062&gt; 
Mar  2 14:40:04 HSS /opt/OpenIMSCore/ser_ims/ser[3220]: 
DBG:P-CSCF:P_security_401: Security-Client header found : &lt;ipsec-3gpp; 
ealg=aes-cbc; alg=hmac-md5-96; spi-c=1024; spi-s=2048; port-c=12345; 
port-s=3062; q=0.1&gt;.
Mar  2 14:40:04 HSS /opt/OpenIMSCore/ser_ims/ser[3220]: 
INF:P-CSCF:execute_cmd: 
[/opt/OpenIMSCore/ser_ims/modules/pcscf/ipsec_P_Inc_Req.sh 172.28.0.102 
12345 172.28.0.10 5060 5005 rijndael-cbc 
0xa119cf14b11b557ad46f962c5b99cb81 hmac-md5 
0x2a04c509899cac24760acabb2a080aaa esp trans]
Mar  2 14:40:09 HSS /opt/OpenIMSCore/ser_ims/ser[3226]: 
INF:P-CSCF:----------  Registrar Contents begin --------
Mar  2 14:40:09 HSS /opt/OpenIMSCore/ser_ims/ser[3226]: 
^[[01;32mINF:P-CSCF:[ 145] C: &lt;^[[01;31m0://172.28.0.102:3062^[[01;32m&gt; 
Exp:[^[[01;35m  55^[[01;32m] R:[^[[01;35m-1^[[01;32m] SOS:[^[[01;35m 
^[[01;32m] &lt;sip:<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">alice at 172.28.0.102</A>:3062&gt;
Mar  2 14:40:09 HSS /opt/OpenIMSCore/ser_ims/ser[3226]: 
^[[01;32mINF:P-CSCF:        Temp.IPSec: UAS: 1024:12345-&gt;5005  UAC: 
2048:3062&lt;-5004 E[rijndael-cbc] I[hmac-md5]
Mar  2 14:40:09 HSS /opt/OpenIMSCore/ser_ims/ser[3226]: 
INF:P-CSCF:----------  Registrar Contents end ----------
Mar  2 14:40:09 HSS /opt/OpenIMSCore/ser_ims/ser[3226]: 
^[[01;32mINF:P-CSCF:----------  Subscription list begin ---------
Mar  2 14:40:09 HSS /opt/OpenIMSCore/ser_ims/ser[3226]: 
^[[01;32mINF:P-CSCF:----------  Subscription list end -----------
Mar  2 14:40:19 HSS /opt/OpenIMSCore/ser_ims/ser[3226]: 
INF:P-CSCF:----------  Registrar Contents begin --------
Mar  2 14:40:19 HSS /opt/OpenIMSCore/ser_ims/ser[3226]: 
^[[01;32mINF:P-CSCF:[ 145] C: &lt;^[[01;31m0://172.28.0.102:3062^[[01;32m&gt; 
Exp:[^[[01;35m  45^[[01;32m] R:[^[[01;35m-1^[[01;32m] SOS:[^[[01;35m 
^[[01;32m] &lt;sip:<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">alice at 172.28.0.102</A>:3062&gt;
Mar  2 14:40:19 HSS /opt/OpenIMSCore/ser_ims/ser[3226]: 
^[[01;32mINF:P-CSCF:        Temp.IPSec: UAS: 1024:12345-&gt;5005  UAC: 
2048:3062&lt;-5004 E[rijndael-cbc] I[hmac-md5]
Mar  2 14:40:19 HSS /opt/OpenIMSCore/ser_ims/ser[3226]: 
INF:P-CSCF:----------  Registrar Contents end ----------
Mar  2 14:40:19 HSS /opt/OpenIMSCore/ser_ims/ser[3226]: 
^[[01;32mINF:P-CSCF:----------  Subscription list begin ---------
Mar  2 14:40:19 HSS /opt/OpenIMSCore/ser_ims/ser[3226]: 
^[[01;32mINF:P-CSCF:----------  Subscription list end -----------
Mar  2 14:40:29 HSS /opt/OpenIMSCore/ser_ims/ser[3226]: 
INF:P-CSCF:----------  Registrar Contents begin --------
Mar  2 14:40:29 HSS /opt/OpenIMSCore/ser_ims/ser[3226]: 
^[[01;32mINF:P-CSCF:[ 145] C: &lt;^[[01;31m0://172.28.0.102:3062^[[01;32m&gt; 
Exp:[^[[01;35m  35^[[01;32m] R:[^[[01;35m-1^[[01;32m] SOS:[^[[01;35m 
^[[01;32m] &lt;sip:<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">alice at 172.28.0.102</A>:3062&gt;
Mar  2 14:40:29 HSS /opt/OpenIMSCore/ser_ims/ser[3226]: 
^[[01;32mINF:P-CSCF:        Temp.IPSec: UAS: 1024:12345-&gt;5005  UAC: 
2048:3062&lt;-5004 E[rijndael-cbc] I[hmac-md5]
Mar  2 14:40:29 HSS /opt/OpenIMSCore/ser_ims/ser[3226]: 
INF:P-CSCF:----------  Registrar Contents end ----------
Mar  2 14:40:29 HSS /opt/OpenIMSCore/ser_ims/ser[3226]: 
^[[01;32mINF:P-CSCF:----------  Subscription list begin ---------
Mar  2 14:40:29 HSS /opt/OpenIMSCore/ser_ims/ser[3226]: 
^[[01;32mINF:P-CSCF:----------  Subscription list end -----------
Mar  2 14:40:39 HSS /opt/OpenIMSCore/ser_ims/ser[3226]: 
INF:P-CSCF:----------  Registrar Contents begin --------
Mar  2 14:40:39 HSS /opt/OpenIMSCore/ser_ims/ser[3226]: 
^[[01;32mINF:P-CSCF:[ 145] C: &lt;^[[01;31m0://172.28.0.102:3062^[[01;32m&gt; 
Exp:[^[[01;35m  25^[[01;32m] R:[^[[01;35m-1^[[01;32m] SOS:[^[[01;35m 
^[[01;32m] &lt;sip:<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">alice at 172.28.0.102</A>:3062&gt;
Mar  2 14:40:39 HSS /opt/OpenIMSCore/ser_ims/ser[3226]: 
^[[01;32mINF:P-CSCF:        Temp.IPSec: UAS: 1024:12345-&gt;5005  UAC: 
2048:3062&lt;-5004 E[rijndael-cbc] I[hmac-md5]
Mar  2 14:40:39 HSS /opt/OpenIMSCore/ser_ims/ser[3226]: 
INF:P-CSCF:----------  Registrar Contents end ----------
Mar  2 14:40:39 HSS /opt/OpenIMSCore/ser_ims/ser[3226]: 
^[[01;32mINF:P-CSCF:----------  Subscription list begin ---------
Mar  2 14:40:39 HSS /opt/OpenIMSCore/ser_ims/ser[3226]: 
^[[01;32mINF:P-CSCF:----------  Subscription list end -----------
Mar  2 14:40:48 HSS /opt/OpenIMSCore/ser_ims/ser[3226]: 
INF:P-CSCF:----------  P-CSCF Dialog List begin --------------
Mar  2 14:40:48 HSS /opt/OpenIMSCore/ser_ims/ser[3226]: 
INF:P-CSCF:----------  P-CSCF Dialog List end   --------------
Mar  2 14:40:49 HSS /opt/OpenIMSCore/ser_ims/ser[3226]: 
INF:P-CSCF:----------  Registrar Contents begin --------
Mar  2 14:40:49 HSS /opt/OpenIMSCore/ser_ims/ser[3226]: 
^[[01;32mINF:P-CSCF:[ 145] C: &lt;^[[01;31m0://172.28.0.102:3062^[[01;32m&gt; 
Exp:[^[[01;35m  15^[[01;32m] R:[^[[01;35m-1^[[01;32m] SOS:[^[[01;35m 
^[[01;32m] &lt;sip:<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">alice at 172.28.0.102</A>:3062&gt;
Mar  2 14:40:49 HSS /opt/OpenIMSCore/ser_ims/ser[3226]: 
^[[01;32mINF:P-CSCF:        Temp.IPSec: UAS: 1024:12345-&gt;5005  UAC: 
2048:3062&lt;-5004 E[rijndael-cbc] I[hmac-md5]
Mar  2 14:40:49 HSS /opt/OpenIMSCore/ser_ims/ser[3226]: 
INF:P-CSCF:----------  Registrar Contents end ----------
Mar  2 14:40:49 HSS /opt/OpenIMSCore/ser_ims/ser[3226]: 
^[[01;32mINF:P-CSCF:----------  Subscription list begin ---------
Mar  2 14:40:49 HSS /opt/OpenIMSCore/ser_ims/ser[3226]: 
^[[01;32mINF:P-CSCF:----------  Subscription list end -----------
Mar  2 14:40:59 HSS /opt/OpenIMSCore/ser_ims/ser[3226]: 
INF:P-CSCF:----------  Registrar Contents begin --------
Mar  2 14:40:59 HSS /opt/OpenIMSCore/ser_ims/ser[3226]: 
^[[01;32mINF:P-CSCF:[ 145] C: &lt;^[[01;31m0://172.28.0.102:3062^[[01;32m&gt; 
Exp:[^[[01;35m   5^[[01;32m] R:[^[[01;35m-1^[[01;32m] SOS:[^[[01;35m 
^[[01;32m] &lt;sip:<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">alice at 172.28.0.102</A>:3062&gt;
Mar  2 14:40:59 HSS /opt/OpenIMSCore/ser_ims/ser[3226]: 
^[[01;32mINF:P-CSCF:        Temp.IPSec: UAS: 1024:12345-&gt;5005  UAC: 
2048:3062&lt;-5004 E[rijndael-cbc] I[hmac-md5]
Mar  2 14:40:59 HSS /opt/OpenIMSCore/ser_ims/ser[3226]: 
INF:P-CSCF:----------  Registrar Contents end ----------
Mar  2 14:40:59 HSS /opt/OpenIMSCore/ser_ims/ser[3226]: 
^[[01;32mINF:P-CSCF:----------  Subscription list begin ---------
Mar  2 14:40:59 HSS /opt/OpenIMSCore/ser_ims/ser[3226]: 
^[[01;32mINF:P-CSCF:----------  Subscription list end -----------
Mar  2 14:41:09 HSS /opt/OpenIMSCore/ser_ims/ser[3226]: 
INF:P-CSCF:execute_cmd: 
[/opt/OpenIMSCore/ser_ims/modules/pcscf/ipsec_P_Drop.sh 172.28.0.102 
12345 3062 172.28.0.10 5060 5060 1024 2048 5004 5005 esp]
Mar  2 14:41:10 HSS /opt/OpenIMSCore/ser_ims/ser[3226]: 
INF:P-CSCF:----------  Registrar Contents begin --------


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="006111.html">[OpenIMSCore-Users] Address selection in P-CSCF
</A></li>
	<LI>Next message: <A HREF="006113.html">[OpenIMSCore-Users] S-CSCF error during register with DeReg	tickedin REGISTER method trigger
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6112">[ date ]</a>
              <a href="thread.html#6112">[ thread ]</a>
              <a href="subject.html#6112">[ subject ]</a>
              <a href="author.html#6112">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/openimscore-users">More information about the OpenIMSCore-Users
mailing list</a><br>
</body></html>
