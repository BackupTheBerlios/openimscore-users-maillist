<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [OpenIMSCore-Users] IMS level registration and OSIMS
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/openimscore-users/2007-January/index.html" >
   <LINK REL="made" HREF="mailto:openimscore-users%40lists.berlios.de?Subject=Re%3A%20%5BOpenIMSCore-Users%5D%20IMS%20level%20registration%20and%20OSIMS&In-Reply-To=%3C45B781BC.8040701%40fokus.fraunhofer.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000534.html">
   <LINK REL="Next"  HREF="000535.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[OpenIMSCore-Users] IMS level registration and OSIMS</H1>
    <B>Dragos Vingarzan</B> 
    <A HREF="mailto:openimscore-users%40lists.berlios.de?Subject=Re%3A%20%5BOpenIMSCore-Users%5D%20IMS%20level%20registration%20and%20OSIMS&In-Reply-To=%3C45B781BC.8040701%40fokus.fraunhofer.de%3E"
       TITLE="[OpenIMSCore-Users] IMS level registration and OSIMS">vingarzan at fokus.fraunhofer.de
       </A><BR>
    <I>Wed Jan 24 16:56:44 CET 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="000534.html">[OpenIMSCore-Users] IMS level registration and OSIMS
</A></li>
        <LI>Next message: <A HREF="000535.html">[OpenIMSCore-Users] Queried public identity does not contain	configured &quot;Phone URL&quot;...
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#541">[ date ]</a>
              <a href="thread.html#541">[ thread ]</a>
              <a href="subject.html#541">[ subject ]</a>
              <a href="author.html#541">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello Bindu,

Please check your client with respect to the RFC3310. The latest version
works even with the latest Nokia phones and real AKA UICC SIM cards, so
we kind of think it is correct now.

(The AKA server part is in S-CSCF and you can also see a client part in
the SIP2IMS Gateway)

-Dragos


Bindu B Pillai wrote:
&gt;<i>
</I>&gt;<i> I just realised, I didn't post this to the user
</I>&gt;<i> group...
</I>&gt;<i>
</I>&gt;<i> Here is the error I see on the SCSCF window when I try
</I>&gt;<i> to register. This is the same error I saw with my
</I>&gt;<i> older version as well (taken early-mid december). So
</I>&gt;<i> whatever changes were in effect for AKA
</I>&gt;<i> authentication... didn't really make a difference to
</I>&gt;<i> scenario where the IMS client is trying to register.
</I>&gt;<i>
</I>&gt;<i> 12(2292) DBG:sm_process(): Peer hss.open-ims.test    
</I>&gt;<i>  State I_Open    Event I_Rcv_Message
</I>&gt;<i>
</I>&gt;<i>  1(2248) DBG:S-CSCF:S_is_authorized: UE said:
</I>&gt;<i> 980f84bb3feb63b90c997eb0d7d75114 and we  expect
</I>&gt;<i> e1995e3f17d131b714e95e85b6a3a825 ha1
</I>&gt;<i> ab6bb1e2d50c60f36109c998a30eecb8
</I>&gt;<i>
</I>&gt;<i> 12(2292) DBG:sm_process(): Peer hss.open-ims.test    
</I>&gt;<i>  State I_Open    Event I_Rcv_Message
</I>&gt;<i>
</I>&gt;<i>  1(2248) DBG:S-CSCF:S_is_authorized: UE said:
</I>&gt;<i> f7b06be68aa56ca4f9f4366defa26ea6 and we  expect
</I>&gt;<i> 5e14424b8935c5e587f53e7be6b3766d ha1
</I>&gt;<i> 58a3bdd8fdb34c3a79e2e276c60bf363
</I>&gt;<i>
</I>&gt;<i> --- Bindu B Pillai &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">bbp44 at yahoo.com</A>&gt; wrote:
</I>&gt;<i>
</I>&gt;<i> &gt; Hi Dragos...
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; So if I were not using the SIP2IMS gateway... the
</I>&gt;<i> &gt; AKA
</I>&gt;<i> &gt; fix is not in effect then? correct?
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; What is the latest AKA fix?
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Thanks,
</I>&gt;<i> &gt; -bindu
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; --- Dragos Vingarzan &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">vingarzan at fokus.fraunhofer.de</A>&gt;
</I>&gt;<i> &gt; wrote:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; &gt; Then the question would be: Is the client
</I>&gt;<i> &gt; up-to-date
</I>&gt;<i> &gt; &gt; with the latest AKA
</I>&gt;<i> &gt; &gt; fix? The SIP2IMS gateway is.
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; OP and AMF - we are usually filling them with
</I>&gt;<i> &gt; zeros
</I>&gt;<i> &gt; &gt; for easier
</I>&gt;<i> &gt; &gt; debugging. They are essential. Try to find out the
</I>&gt;<i> &gt; &gt; values pre-compiled
</I>&gt;<i> &gt; &gt; in the client (if they are not configurable) and
</I>&gt;<i> &gt; &gt; then provision the same
</I>&gt;<i> &gt; &gt; values in the HSS.
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; -Dragos
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; Bindu B Pillai wrote:
</I>&gt;<i> &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; I downloaded the latest version and tried to run
</I>&gt;<i> &gt; &gt; the
</I>&gt;<i> &gt; &gt; &gt; REGISTER message from the IMS client again.
</I>&gt;<i> &gt; &gt; &gt; I get the same 401 messages as with the previous
</I>&gt;<i> &gt; &gt; rev.
</I>&gt;<i> &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; What can I look at further on the core side, to
</I>&gt;<i> &gt; &gt; help
</I>&gt;<i> &gt; &gt; &gt; debug the scenario? The IMS client is configured
</I>&gt;<i> &gt; &gt; as
</I>&gt;<i> &gt; &gt; &gt; given in the installation guide. The only
</I>&gt;<i> &gt; missing
</I>&gt;<i> &gt; &gt; part
</I>&gt;<i> &gt; &gt; &gt; is OP and AMF - I don't know what these are. Are
</I>&gt;<i> &gt; &gt; these
</I>&gt;<i> &gt; &gt; &gt; essential for a successful registration?
</I>&gt;<i> &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; How can I look at what actual key is being
</I>&gt;<i> &gt; shared
</I>&gt;<i> &gt; &gt; in
</I>&gt;<i> &gt; &gt; &gt; the messages?
</I>&gt;<i> &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; Thanks,
</I>&gt;<i> &gt; &gt; &gt; -bindu
</I>&gt;<i> &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; --- Dragos Vingarzan
</I>&gt;<i> &gt; &gt; &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">vingarzan at fokus.fraunhofer.de</A>&gt;
</I>&gt;<i> &gt; &gt; &gt; wrote:
</I>&gt;<i> &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; &gt; But Bindu, the headers received and sent by
</I>&gt;<i> &gt; the
</I>&gt;<i> &gt; &gt; &gt; &gt; SIP2IMS are completely
</I>&gt;<i> &gt; &gt; &gt; &gt; different on the 2 sides. There are 2
</I>&gt;<i> &gt; &gt; authorization
</I>&gt;<i> &gt; &gt; &gt; &gt; happening:
</I>&gt;<i> &gt; &gt; &gt; &gt; - one between the SIP client and the SIP2IMS
</I>&gt;<i> &gt; &gt; gateway
</I>&gt;<i> &gt; &gt; &gt; &gt; as a server - that
</I>&gt;<i> &gt; &gt; &gt; &gt; is MD5
</I>&gt;<i> &gt; &gt; &gt; &gt; - one between the SIP2IMS gateway as a client
</I>&gt;<i> &gt; &gt; and
</I>&gt;<i> &gt; &gt; &gt; &gt; the IMS Core as a
</I>&gt;<i> &gt; &gt; &gt; &gt; server - that is AKAv1-MD5
</I>&gt;<i> &gt; &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; &gt; They happen in &quot;parallel&quot; and if the first is
</I>&gt;<i> &gt; &gt; &gt; &gt; successful, the the
</I>&gt;<i> &gt; &gt; &gt; &gt; SIP2IMS gateway will try and make the 2nd one
</I>&gt;<i> &gt; &gt; &gt; &gt; successful.
</I>&gt;<i> &gt; &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; &gt; Regarding authorization with an AKA client,
</I>&gt;<i> &gt; &gt; there
</I>&gt;<i> &gt; &gt; &gt; &gt; was recent fix. Please
</I>&gt;<i> &gt; &gt; &gt; &gt; see the revision 84 log:
</I>&gt;<i> &gt; &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> <A HREF="https://lists.berlios.de/pipermail/openimscore-cscf/2007-January/000121.html">https://lists.berlios.de/pipermail/openimscore-cscf/2007-January/000121.html</A>
</I>&gt;<i> &gt; &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; &gt; -Dragos
</I>&gt;<i> &gt; &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; &gt; Bindu B Pillai wrote:
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; OK... help me understand this then.
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; To start with, I used the Xlite through the
</I>&gt;<i> &gt; &gt; &gt; &gt; sip2ims
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; gateway. The registration worked.
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; With the IMS client, i'm not able to get it
</I>&gt;<i> &gt; to
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; register.
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; Here is the output from Xlite soft sip phone
</I>&gt;<i> &gt; &gt; &gt; &gt; working
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; with the sip2ims gateway for registration.
</I>&gt;<i> &gt; The
</I>&gt;<i> &gt; &gt; 2nd
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; REGISTER message sent has the nonce from the
</I>&gt;<i> &gt; &gt; 401
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; message received, but the response is
</I>&gt;<i> &gt; &gt; different.
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; Should this be a 1 to 1 match is my
</I>&gt;<i> &gt; question.
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; REGISTER sip:open-ims.test SIP/2.0
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; Via: SIP/2.0/UDP
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> 172.16.0.11:26418;branch=z9hG4bK-d87543-3b550060c5029939-1--d87543-;rport
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; Max-Forwards: 70
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; Contact:
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &lt;sip:<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">alice at 172.16.0.11</A>:26418;rinstance=57a223723d7be6f1&gt;
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; To: &quot;&quot;Alice&quot;&quot;&lt;sip:<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">alice at open-ims.test</A>&gt;
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; From:
</I>&gt;<i> &gt; &gt; &gt; &gt;
</I>&gt;<i> &gt; &quot;&quot;Alice&quot;&quot;&lt;sip:<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">alice at open-ims.test</A>&gt;;tag=a704b36c
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; Call-ID:
</I>&gt;<i> &gt; &gt; &gt; &gt; ZWM4YWIzNTExZGRjMzQyNzYzNmM2YWIxY2VlZGIyYWU.
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; CSeq: 1 REGISTER
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; Expires: 3600
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; Allow: INVITE, ACK, CANCEL, OPTIONS, BYE,
</I>&gt;<i> &gt; &gt; REFER,
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; NOTIFY, MESSAGE, SUBSCRIBE, INFO
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; User-Agent: X-Lite release 1006e stamp 34025
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; Content-Length: 0
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; SIP/2.0 401 Unauthorized - Challenging the
</I>&gt;<i> &gt; UE
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; Via: SIP/2.0/UDP
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> 172.16.0.11:26418;branch=z9hG4bK-d87543-3b550060c5029939-1--d87543-;rport=26418
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; Path: &lt;sip:<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">term at pcscf.open-ims.test</A>:4060;lr&gt;
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; Service-Route:
</I>&gt;<i> &gt; &gt; &gt; &gt; &lt;sip:<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">orig at scscf.open-ims.test</A>:6060;lr&gt;
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; To:
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &quot;&quot;Alice&quot;&quot;&lt;sip:<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">alice at open-ims.test</A>&gt;;tag=8a8b4a4bfe6e9e279a0f819adaa9fa5e-15e0
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; From:
</I>&gt;<i> &gt; &gt; &gt; &gt;
</I>&gt;<i> &gt; &quot;&quot;Alice&quot;&quot;&lt;sip:<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">alice at open-ims.test</A>&gt;;tag=a704b36c
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; Call-ID:
</I>&gt;<i> &gt; &gt; &gt; &gt; ZWM4YWIzNTExZGRjMzQyNzYzNmM2YWIxY2VlZGIyYWU.
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; CSeq: 1 REGISTER
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; Server: Sip EXpress router
</I>&gt;<i> &gt; &gt; (0.10.99-dev53-tm_fixes
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; (i386/linux))
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; Warning: 392 192.168.64.2:6060 &quot;&quot;Noisy
</I>&gt;<i> &gt; &gt; feedback
</I>&gt;<i> &gt; &gt; &gt; &gt; tells:
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt;  pid=23809 req_src_ip=192.168.64.2
</I>&gt;<i> &gt; &gt; &gt; &gt; req_src_port=5060
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; in_uri=sip:scscf.open-ims.test:6060
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; out_uri=sip:scscf.open-ims.test:6060
</I>&gt;<i> &gt; &gt; via_cnt==4&quot;&quot;
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; WWW-Authenticate: Digest
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; username=&quot;&quot;<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">alice at open-ims.test</A>&quot;&quot;,
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; realm=&quot;&quot;open-ims.test&quot;&quot;,
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> opaque=&quot;&quot;AKAv1-MD5ETKl/AmZLeLQGGkEahISbwAAAAABNAAAUg2QxyjnlpE=&quot;&quot;,
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; nonce=&quot;&quot;45a5159f3ee620dc5f79b32027e4753f9e231463&quot;&quot;,
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; algorithm=MD5
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; Content-Length: 0
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; REGISTER sip:open-ims.test SIP/2.0
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; Via: SIP/2.0/UDP
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> 172.16.0.11:26418;branch=z9hG4bK-d87543-19411c32c739c507-1--d87543-;rport
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; Max-Forwards: 70
</I>&gt;<i> &gt;
</I>&gt;<i> === message truncated ===
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> ____________________________________________________________________________________
</I>&gt;<i> Sucker-punch spam with award-winning protection.
</I>&gt;<i> Try the free Yahoo! Mail Beta.
</I>&gt;<i> <A HREF="http://advision.webevents.yahoo.com/mailbeta/features_spam.html">http://advision.webevents.yahoo.com/mailbeta/features_spam.html</A>
</I>&gt;<i>
</I>

-- 
-----------------------------------------
Dipl. Eng. Dragos Vingarzan
FOKUS/NGNI
Kaiserin-Augusta-Allee 31
10589 Berlin,Germany
Phone +49 (0)30 - 3463 - 7385
Mobile +49 (0)163 - 159 - 5221
eMail <A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">vingarzan at fokus.fraunhofer.de</A>
Web www.fokus.fraunhofer.de
We could change the world if God would give us the source code...
-----------------------------------------------------------------


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000534.html">[OpenIMSCore-Users] IMS level registration and OSIMS
</A></li>
	<LI>Next message: <A HREF="000535.html">[OpenIMSCore-Users] Queried public identity does not contain	configured &quot;Phone URL&quot;...
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#541">[ date ]</a>
              <a href="thread.html#541">[ thread ]</a>
              <a href="subject.html#541">[ subject ]</a>
              <a href="author.html#541">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/openimscore-users">More information about the OpenIMSCore-Users
mailing list</a><br>
</body></html>
