<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [OpenIMSCore-Users] Implementing many HSSs
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/openimscore-users/2007-November/index.html" >
   <LINK REL="made" HREF="mailto:openimscore-users%40lists.berlios.de?Subject=Re%3A%20%5BOpenIMSCore-Users%5D%20Implementing%20many%20HSSs&In-Reply-To=%3COF9F821C4A.57B02082-ONC12573A0.00386882-C12573A0.0039AF53%40amper.es%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002956.html">
   <LINK REL="Next"  HREF="003024.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[OpenIMSCore-Users] Implementing many HSSs</H1>
    <B>Pedro Antonio Vico Solano</B> 
    <A HREF="mailto:openimscore-users%40lists.berlios.de?Subject=Re%3A%20%5BOpenIMSCore-Users%5D%20Implementing%20many%20HSSs&In-Reply-To=%3COF9F821C4A.57B02082-ONC12573A0.00386882-C12573A0.0039AF53%40amper.es%3E"
       TITLE="[OpenIMSCore-Users] Implementing many HSSs">pvsolano at amper.es
       </A><BR>
    <I>Tue Nov 27 11:24:24 CET 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="002956.html">[OpenIMSCore-Users] Implementing many HSSs
</A></li>
        <LI>Next message: <A HREF="003024.html">[OpenIMSCore-Users] Implementing many HSSs
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3017">[ date ]</a>
              <a href="thread.html#3017">[ thread ]</a>
              <a href="subject.html#3017">[ subject ]</a>
              <a href="author.html#3017">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello Dragos,

I attach you a capture where both I-CSCF2 and S-CSCF register themselves 
on HSS and HSS1.




The initial log on icscf2 is the following:

 0(4021) Diameter Peer Config:
 0(4021)        FQDN    : icscf2.open-ims.test
 0(4021)        Realm   : open-ims.test
 0(4021)        VendorID: 10415
 0(4021)        ProdName: CDiameterPeer
 0(4021)        AcceptUn: [X]
 0(4021)        DropUnkn: [X]
 0(4021)        Tc      : 30
 0(4021)        Workers : 4
 0(4021)        QueueLen: 8
 0(4021)        Peers : 2
 0(4021)                FQDN:  hss.open-ims.test         Realm: 
open-ims.test    Port: 3868
 0(4021)                FQDN:  hss1.open-ims.test        Realm: 
open-ims.test    Port: 3868
 0(4021)        Acceptors : 1
 0(4021)                Port:  3869      Bind: 10.0.2.2
 0(4021)        Applications : 3
 0(4021)                Auth ID:  16777216       Vendor: 10415
 0(4021)                Auth ID:  16777216       Vendor: 4491
 0(4021)                Auth ID:  16777216       Vendor: 13019
 0(4021)        Routing Table :
 0(4021)                DefaultRoute: [  10] hss.open-ims.test
 0(4021)                DefaultRoute: [  20] hss1.open-ims.test       


Maybe is it a problem of configuration? or a misundersating between &quot;realm 
routing&quot; and &quot;default routing&quot;?

Best regards
Pedro





Dragos Vingarzan &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">Dragos.Vingarzan at fokus.fraunhofer.de</A>&gt; 
20/11/2007 12:38

Para
Pedro Antonio Vico Solano &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">pvsolano at amper.es</A>&gt;
cc
<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">openimscore-users at lists.berlios.de</A>
Asunto
--SPAM--:Re: [OpenIMSCore-Users] Implementing many HSSs






Hi Pedro,

Are the hss and hss1 peers connected? In case they are, could you please
send a trace including the CER/CEA for the connection?

it might be that the HSS peers do not advertise support for the Cx
application id...

-Dragos

Pedro Antonio Vico Solano wrote:
&gt;<i>
</I>&gt;<i> Hello Drago,
</I>&gt;<i>
</I>&gt;<i> Thanks a lot.
</I>&gt;<i>
</I>&gt;<i> I'm trying to test it but I get a error. I have two HSSs, one with
</I>&gt;<i> metric 10 that is off and one with metric 20 that is on. Both are
</I>&gt;<i> peers of the I-CSCF &amp; S-CSCF. But I get the following error on the
</I>&gt;<i> I-CSCF log when a user tries to register:
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> 12(2817) --- Peer List: ---
</I>&gt;<i> 12(2817)  S[Closed] hss1.open-ims.test:3868 D[ ]
</I>&gt;<i> 12(2817)  S[I_Open] hss.open-ims.test:3868 D[ ]
</I>&gt;<i> 12(2817)         [16777216,10415]
</I>&gt;<i> 12(2817)         [16777216,4491]
</I>&gt;<i> 12(2817)         [16777216,13019]
</I>&gt;<i> 12(2817)         [16777217,10415]
</I>&gt;<i> 12(2817)         [16777221,10415]
</I>&gt;<i> 12(2817) ------------------
</I>&gt;<i>  3(2808) ERR:I-CSCF:cscf_get_private_identity: Message does not
</I>&gt;<i> contain Authorization header.
</I>&gt;<i>  3(2808) INF:I-CSCF:cscf_get_private_identity: Falling back to
</I>&gt;<i> private_id=stripped(public_id)
</I>&gt;<i> -&gt; Message did not contain a valid Authorization Header!!! This
</I>&gt;<i> fallback is deprecated outside Early-IMS or NASS-Bundled!
</I>&gt;<i> * 3(2808) ERROR:get_routing_peer(): No connected DefaultRoute peer
</I>&gt;<i> found.*
</I>&gt;<i> * 3(2808) ERROR:AAASendRecvMessage(): Can't find a suitable connected
</I>&gt;<i> peer in the routing table.*
</I>&gt;<i> * 3(2808) ERR:I-CSCF:I_UAR: Error creating/sending UAR or UAR time-out*
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> And the XML file for I-CSCF is the following:
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> have I missed anything?
</I>&gt;<i>
</I>&gt;<i> Thanks.
</I>&gt;<i> Pedro.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> *Dragos Vingarzan &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">Dragos.Vingarzan at fokus.fraunhofer.de</A>&gt;*
</I>&gt;<i>
</I>&gt;<i> 14/11/2007 20:32
</I>&gt;<i>
</I>&gt;<i> 
</I>&gt;<i> Para
</I>&gt;<i>                Pedro Antonio Vico Solano &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">pvsolano at amper.es</A>&gt;
</I>&gt;<i> cc
</I>&gt;<i>                <A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">openimscore-users at lists.berlios.de</A>
</I>&gt;<i> Asunto
</I>&gt;<i>                Re: [OpenIMSCore-Users] Implementing many HSSs
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> 
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Hello Pedro,
</I>&gt;<i>
</I>&gt;<i> Here is some text from our workshop tomorrow here at FOKUS:
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> &lt;Realm&gt;  defines routing for a specific realm
</I>&gt;<i>    &lt;Route&gt; - defines a specific route point, with an attached metric
</I>&gt;<i>
</I>&gt;<i> &lt;DefaultRoute&gt; - defines a default route with an attached metric to be
</I>&gt;<i> used in case a Realm-specific  route is not found or not available
</I>&gt;<i>
</I>&gt;<i> Message are routed based on, in order
</I>&gt;<i> 1. Presence of a Destination-Host AVP in the message
</I>&gt;<i> 2. Presence of a Destination-Realm AVP in the message
</I>&gt;<i> 2.1 If this realm is defined in the configuration, the shortest metric
</I>&gt;<i> connected and suitable peer is selected
</I>&gt;<i> 2.2 If this realm is not defined or the previous point fails, a similar
</I>&gt;<i> selection is performed on the default routes
</I>&gt;<i>
</I>&gt;<i> The selection is based on
</I>&gt;<i> 1. Connection status
</I>&gt;<i> 2. Advertised support for the Application ID for the message
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> So, the idea is that if there is no destination-host or we are not
</I>&gt;<i> connected to the destination-host, another peer is selected by looking
</I>&gt;<i> first in the realm-specific section and if not found there, in the
</I>&gt;<i> default-routes. The peers are ordered by metric and only selected if
</I>&gt;<i> connected and supporting the required application.
</I>&gt;<i>
</I>&gt;<i> Hope this explains it.
</I>&gt;<i>
</I>&gt;<i> Cheers,
</I>&gt;<i> -Dragos
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Pedro Antonio Vico Solano wrote:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Hello all,
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; I was wondering about the functionality of 'Realm Routing' or many
</I>&gt;<i> &gt; 'Default Routes' on I-CSCF &amp; S-CSCF XMLs. What is the difference
</I>&gt;<i> &gt; between them?
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Can I do some of the following on a domain?:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; - Configure some users in a HSS and some others in another HSS and let
</I>&gt;<i> &gt; the I-CSCF &amp; S-CSCF search for the correct one. [i.e. pseudo SLF
</I>&gt;<i> &gt; function]
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; - Configure the same users in two HSSs and give network relialibility
</I>&gt;<i> &gt; when one of them fails. In this case, when a HSS fails, registration
</I>&gt;<i> &gt; states are lost, aren't they?
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Best regards
</I>&gt;<i> &gt; Pedro
</I>&gt;<i> &gt; 
</I>------------------------------------------------------------------------
&gt;<i> &gt;
</I>&gt;<i> &gt; _______________________________________________
</I>&gt;<i> &gt; OpenIMSCore-Users mailing list
</I>&gt;<i> &gt; <A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">OpenIMSCore-Users at lists.berlios.de</A>
</I>&gt;<i> &gt; <A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">https://lists.berlios.de/mailman/listinfo/openimscore-users</A>
</I>&gt;<i> &gt; 
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> -- 
</I>&gt;<i> -----------------------------------------
</I>&gt;<i> Dipl. Eng. Dragos Vingarzan
</I>&gt;<i> Fraunhofer FOKUS/NGNI
</I>&gt;<i> Kaiserin-Augusta-Allee 31
</I>&gt;<i> 10589 Berlin,Germany
</I>&gt;<i> Phone +49 (0)30 - 3463 - 7385
</I>&gt;<i> Mobile +49 (0)163 - 159 - 5221
</I>&gt;<i> Web www.fokus.fraunhofer.de www.openimscore.org
</I>&gt;<i> We could change the world if God would give us the source code...
</I>&gt;<i> -----------------------------------------------------------------
</I>&gt;<i>
</I>&gt;<i>
</I>

-- 
-----------------------------------------
Dipl. Eng. Dragos Vingarzan
Fraunhofer FOKUS/NGNI
Kaiserin-Augusta-Allee 31
10589 Berlin,Germany
Phone +49 (0)30 - 3463 - 7385
Mobile +49 (0)163 - 159 - 5221
Web www.fokus.fraunhofer.de www.openimscore.org
We could change the world if God would give us the source code...
-----------------------------------------------------------------


-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="https://lists.berlios.de/pipermail/openimscore-users/attachments/20071127/9c169630/attachment.html">https://lists.berlios.de/pipermail/openimscore-users/attachments/20071127/9c169630/attachment.html</A>&gt;
-------------- next part --------------
A non-text attachment was scrubbed...
Name: CAR+CEA_2_HSSs.pcap
Type: application/octet-stream
Size: 2760 bytes
Desc: not available
URL: &lt;<A HREF="https://lists.berlios.de/pipermail/openimscore-users/attachments/20071127/9c169630/attachment.obj">https://lists.berlios.de/pipermail/openimscore-users/attachments/20071127/9c169630/attachment.obj</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002956.html">[OpenIMSCore-Users] Implementing many HSSs
</A></li>
	<LI>Next message: <A HREF="003024.html">[OpenIMSCore-Users] Implementing many HSSs
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3017">[ date ]</a>
              <a href="thread.html#3017">[ thread ]</a>
              <a href="subject.html#3017">[ subject ]</a>
              <a href="author.html#3017">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/openimscore-users">More information about the OpenIMSCore-Users
mailing list</a><br>
</body></html>
