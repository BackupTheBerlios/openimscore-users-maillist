<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [OpenIMSCore-Users] IPsec-issue
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/openimscore-users/2009-March/index.html" >
   <LINK REL="made" HREF="mailto:openimscore-users%40lists.berlios.de?Subject=Re%3A%20%5BOpenIMSCore-Users%5D%20IPsec-issue&In-Reply-To=%3Cbe1da43f0903230307p3d5ad254pc2a27eed9fa5390d%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="005191.html">
   <LINK REL="Next"  HREF="005193.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[OpenIMSCore-Users] IPsec-issue</H1>
    <B>Laurent Etiemble</B> 
    <A HREF="mailto:openimscore-users%40lists.berlios.de?Subject=Re%3A%20%5BOpenIMSCore-Users%5D%20IPsec-issue&In-Reply-To=%3Cbe1da43f0903230307p3d5ad254pc2a27eed9fa5390d%40mail.gmail.com%3E"
       TITLE="[OpenIMSCore-Users] IPsec-issue">laurent.etiemble at inexbee.com
       </A><BR>
    <I>Mon Mar 23 11:07:13 CET 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="005191.html">[OpenIMSCore-Users] IPsec-issue
</A></li>
        <LI>Next message: <A HREF="005193.html">[OpenIMSCore-Users] IPsec-issue
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5192">[ date ]</a>
              <a href="thread.html#5192">[ thread ]</a>
              <a href="subject.html#5192">[ subject ]</a>
              <a href="author.html#5192">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello,

When the client receives the 401 response, there is no security agreement in
place. It is up to the client to select the mecanism with the highest Q
coefficient (see RFC 3329). Once the client has selected the mecanism, it
adds the Security-Verifiy header in the second REGISTER to inform the server
of its choice (and for security reasons). On the second REGISTER, the server
knows which security mecanism is in place, checks the source port and
responds on the protected port.

It is roughly like this:

REGISTER (Client Unprotected Port) --&gt; (Server Unprotected Port)
401 (Server Unprotected Port) --&gt; (Client Unprotected Port)
...Mecanism selected...
REGISTER (Client Protected Port) --&gt; (Server Protected Port)
200 (Server Protected Port) --&gt; (Client Protected Port)

!!! IMPORTANT !!!
I think you have forgotten to launch Mercuro as an administrator (the two
client SPIs are 0). It is needed on Windows Vista to correctly set up the
IPSec Security Associations.

Regards, Laurent Etiemble.

Need an IMS Client ? Why don't you try out Mercuro IMS Client.
More information at <A HREF="http://www.mercuro.net/">http://www.mercuro.net/</A>

2009/3/21 Franz Edler &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">franz-edler at aon.at</A>&gt;:
&gt;<i> Hi,
</I>&gt;<i>
</I>&gt;<i> I just tried to setup an IPsec association and did not succeed. I found
</I>the
&gt;<i> following:
</I>&gt;<i>
</I>&gt;<i> The P-CSCF sends the &quot;401 Unauthorized&quot; to the unprotected port of the
</I>&gt;<i> client instead of using already the protected port of the client.
</I>&gt;<i> This is perhaps the result of the function P_security_relay returning the
</I>&gt;<i> following error (in debug mode):
</I>&gt;<i>   ERR:P-CSCF:P_security_relay: we cannot find the contact or its IPSec/TLS
</I>&gt;<i> SAs for &lt;1://10.0.0.1:2256&gt;
</I>&gt;<i> Remark: Port 2256 is the unprotected port of the client (see also the
</I>&gt;<i> tracefile attached).
</I>&gt;<i>
</I>&gt;<i> I used revision 633.
</I>&gt;<i>
</I>&gt;<i> Regards
</I>&gt;<i> Franz
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="https://lists.berlios.de/pipermail/openimscore-users/attachments/20090323/32cf5a12/attachment.html">https://lists.berlios.de/pipermail/openimscore-users/attachments/20090323/32cf5a12/attachment.html</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="005191.html">[OpenIMSCore-Users] IPsec-issue
</A></li>
	<LI>Next message: <A HREF="005193.html">[OpenIMSCore-Users] IPsec-issue
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5192">[ date ]</a>
              <a href="thread.html#5192">[ thread ]</a>
              <a href="subject.html#5192">[ subject ]</a>
              <a href="author.html#5192">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/openimscore-users">More information about the OpenIMSCore-Users
mailing list</a><br>
</body></html>
