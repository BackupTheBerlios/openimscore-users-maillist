<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [OpenIMSCore-Users] Trigger towards presence server
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/openimscore-users/2007-May/index.html" >
   <LINK REL="made" HREF="mailto:openimscore-users%40lists.berlios.de?Subject=Re%3A%20%5BOpenIMSCore-Users%5D%20Trigger%20towards%20presence%20server&In-Reply-To=%3C67B72BAF01E9A540B4B1F7D031F6D98906BBAD72%40BLR-EC-MBX05.wipro.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001895.html">
   <LINK REL="Next"  HREF="001903.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[OpenIMSCore-Users] Trigger towards presence server</H1>
    <B>kiran.bkumar at wipro.com</B> 
    <A HREF="mailto:openimscore-users%40lists.berlios.de?Subject=Re%3A%20%5BOpenIMSCore-Users%5D%20Trigger%20towards%20presence%20server&In-Reply-To=%3C67B72BAF01E9A540B4B1F7D031F6D98906BBAD72%40BLR-EC-MBX05.wipro.com%3E"
       TITLE="[OpenIMSCore-Users] Trigger towards presence server">kiran.bkumar at wipro.com
       </A><BR>
    <I>Thu May 31 13:18:39 CEST 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="001895.html">[OpenIMSCore-Users] Trigger towards presence server
</A></li>
        <LI>Next message: <A HREF="001903.html">[OpenIMSCore-Users] Trigger towards presence server
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1901">[ date ]</a>
              <a href="thread.html#1901">[ thread ]</a>
              <a href="subject.html#1901">[ subject ]</a>
              <a href="author.html#1901">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
Hi All,

 

In continuation to my previous mail,

 

I have changed the AS address to sip:localhost:5000 and have the openser
presence server is running on port 5000 of the localhost.

 

But the scscf does not send the subscribe message towards the presence
server, but instead I get a response from the scscf itself saying 200
Subscription to REG saved.

 

Is there any change in the scscf/pcscf /hss configuration required???
Attached below is the trace as seen at the ims communicator.

 

One more doubt I have is, the trigger is set to subscribe message, and
SIP header is event and content is &quot;presence&quot;. 

But in the below message, the event is set to &quot;reg&quot;.

 

&lt;message

from=&quot;10.117.2.44:5090&quot; 

to=&quot;10.154.20.45:4060&quot; 

time=&quot;1180609298926&quot; 

isSender=&quot;true&quot; 

transactionId=&quot;z9hG4bK549721be764d34bd132d3e007cdbe76f&quot; 

callId=&quot;<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">a2aeb307177ba577c94f81d660454bc0 at 10.117.2.44</A>&quot; 

firstLine=&quot;SUBSCRIBE sip:<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">wipro2 at mkd149633.wipro.com</A> SIP/2.0&quot; 

debugLine=&quot;0&quot; 

&gt;<i> 
</I>
&lt;![CDATA[SUBSCRIBE sip:<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">wipro2 at mkd149633.wipro.com</A> SIP/2.0

Call-ID: <A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">a2aeb307177ba577c94f81d660454bc0 at 10.117.2.44</A>

CSeq: 1 SUBSCRIBE

From: &quot;wipro2&quot; &lt;sip:<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">wipro2 at mkd149633.wipro.com</A>&gt;;tag=19432672

To: &quot;wipro2&quot; &lt;sip:<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">wipro2 at mkd149633.wipro.com</A>&gt;

Via: SIP/2.0/UDP
10.117.2.44:5090;branch=z9hG4bK549721be764d34bd132d3e007cdbe76f

Max-Forwards: 70

Contact: &lt;sip:<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">wipro2 at 10.117.2.44</A>:5090&gt;

Event:  reg

Expires: 600000

P-Access-Network-Info: IEEE-802.11

Route:
&lt;sip:mkd149633.wipro.com:4060;transport=udp&gt;,&lt;sip:<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">orig at scscf.mkd149633.w</A>
ipro.com:6060;lr&gt;

P-Preferred-Identity: &quot;wipro2&quot; &lt;sip:<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">wipro2 at mkd149633.wipro.com</A>&gt;

Require: sec-agree

Proxy-Require: sec-agree

Accept: application/reginfo+xml

User-Agent: IMS-Communicator 070518

Content-Length: 0

 

]]&gt;

&lt;/message&gt;

 

&lt;message

from=&quot;10.154.20.45:4060&quot; 

to=&quot;10.117.2.44:5090&quot; 

time=&quot;1180609299020&quot; 

isSender=&quot;false&quot; 

statusMessage=&quot;normal processing&quot; 

transactionId=&quot;z9hG4bK549721be764d34bd132d3e007cdbe76f&quot; 

firstLine=&quot;SIP/2.0 200 Subscription to REG saved&quot; 

callId=&quot;<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">a2aeb307177ba577c94f81d660454bc0 at 10.117.2.44</A>&quot; 

debugLine=&quot;0&quot; 

&gt;<i> 
</I>
&lt;![CDATA[SIP/2.0 200 Subscription to REG saved

Record-Route: &lt;sip:<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">mo at pcscf.mkd149633.wipro.com</A>:4060;lr&gt;

Call-ID: <A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">a2aeb307177ba577c94f81d660454bc0 at 10.117.2.44</A>

CSeq: 1 SUBSCRIBE

From: &quot;wipro2&quot; &lt;sip:<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">wipro2 at mkd149633.wipro.com</A>&gt;;tag=19432672

To: &quot;wipro2&quot;
&lt;sip:<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">wipro2 at mkd149633.wipro.com</A>&gt;;tag=91f892d9dea214017c312092c9cda187-84
34

Via: SIP/2.0/UDP
10.117.2.44:5090;received=10.117.2.44;rport=5090;branch=z9hG4bK549721be7
64d34bd132d3e007cdbe76f

Expires: 600000

Server: Sip EXpress router (2.1.0-dev1 OpenIMSCore (i386/linux))

Warning: 392 10.154.20.45:6060 &quot;Noisy feedback tells:  pid=4019
req_src_ip=10.154.20.45 req_src_port=4060
in_uri=sip:<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">wipro2 at mkd149633.wipro.com</A>
out_uri=sip:<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">wipro2 at mkd149633.wipro.com</A> via_cnt==2&quot;

Content-Length: 0

 

]]&gt;

&lt;/message&gt;

 

&lt;message

from=&quot;10.117.2.44:5090&quot; 

to=&quot;10.154.20.45:4060&quot; 

time=&quot;1180609300051&quot; 

isSender=&quot;true&quot; 

transactionId=&quot;z9hG4bKa32e.2716c8e2.0&quot; 

callId=&quot;<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">a2aeb307177ba577c94f81d660454bc0 at 10.117.2.44</A>&quot; 

firstLine=&quot;SIP/2.0 200 OK&quot; 

debugLine=&quot;0&quot; 

&gt;<i> 
</I>
&lt;![CDATA[SIP/2.0 200 OK

Via: SIP/2.0/UDP
10.154.20.45:4060;branch=z9hG4bKa32e.2716c8e2.0,SIP/2.0/UDP
10.154.20.45:6060;received=10.154.20.45;rport=6060;branch=z9hG4bKa32e.42
20c537.0

To: &quot;wipro2&quot; &lt;sip:<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">wipro2 at mkd149633.wipro.com</A>&gt;;tag=19432672

From: &quot;wipro2&quot;
&lt;sip:<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">wipro2 at mkd149633.wipro.com</A>&gt;;tag=91f892d9dea214017c312092c9cda187-84
34

CSeq: 10 NOTIFY

Call-ID: <A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">a2aeb307177ba577c94f81d660454bc0 at 10.117.2.44</A>

Content-Length: 0

 

]]&gt;

&lt;/message&gt;

 

&lt;message

from=&quot;10.154.20.45:4060&quot; 

to=&quot;10.117.2.44:5090&quot; 

time=&quot;1180609300004&quot; 

isSender=&quot;false&quot; 

transactionId=&quot;z9hG4bKa32e.2716c8e2.0&quot; 

callId=&quot;<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">a2aeb307177ba577c94f81d660454bc0 at 10.117.2.44</A>&quot; 

firstLine=&quot;NOTIFY sip:<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">wipro2 at 10.117.2.44</A>:5090 SIP/2.0&quot; 

debugLine=&quot;0&quot; 

&gt;<i> 
</I>
&lt;![CDATA[NOTIFY sip:<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">wipro2 at 10.117.2.44</A>:5090 SIP/2.0

Via: SIP/2.0/UDP
10.154.20.45:4060;branch=z9hG4bKa32e.2716c8e2.0,SIP/2.0/UDP
10.154.20.45:6060;received=10.154.20.45;rport=6060;branch=z9hG4bKa32e.42
20c537.0

To: &quot;wipro2&quot; &lt;sip:<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">wipro2 at mkd149633.wipro.com</A>&gt;;tag=19432672

From: &quot;wipro2&quot;
&lt;sip:<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">wipro2 at mkd149633.wipro.com</A>&gt;;tag=91f892d9dea214017c312092c9cda187-84
34

CSeq: 10 NOTIFY

Call-ID: <A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">a2aeb307177ba577c94f81d660454bc0 at 10.117.2.44</A>

User-Agent: Sip EXpress router(2.1.0-dev1 OpenIMSCore (i386/linux))

Contact: &lt;sip:scscf.mkd149633.wipro.com:6060&gt;

Event:  reg

Max-Forwards: 16

Subscription-State: active;expires=3630

Content-Type: application/reginfo+xml

Content-Length: 340

 

]]&gt;

&lt;/message&gt;

 

 

________________________________

From: <A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">openimscore-users-bounces at lists.berlios.de</A>
[mailto:<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">openimscore-users-bounces at lists.berlios.de</A>] On Behalf Of
<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">kiran.bkumar at wipro.com</A>
Sent: Thursday, May 31, 2007 1:50 PM
To: <A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">openimscore-users at lists.berlios.de</A>
Subject: [OpenIMSCore-Users] Trigger towards presence server

 

 

Hi All,

 

I have done the necessary changes to the HSS to trigger on SIP method
based and the trigger methods are SUBSCRIBE OR PUBLISH. The apsvr table
is also correctly updated with the AS server address

 

mysql&gt; select * from apsvr;

+----------+-------------+-----------------------+------------------+

|<i> apsvr_id | name        | address               | default_handling |
</I>
+----------+-------------+-----------------------+------------------+

|<i>        1 | default_as  |                       |                0 | 
</I>
|<i>        2 | presence_as | sip:10.154.20.45:5000 |                0 | 
</I>
+----------+-------------+-----------------------+------------------+

2 rows in set (0.00 sec)

 

mysql&gt; select * from spt;

+--------+-----------+------------+------------+---------+--------------
+-------------------+--------------------+----------------------+-----+-
--------+------+

|<i> spt_id | trigpt_id | sip_method | sip_header | req_uri | session_case
</I>|<i> session_desc_line | sip_header_content | session_desc_content | neg |
</I>groupId | type |

+--------+-----------+------------+------------+---------+--------------
+-------------------+--------------------+----------------------+-----+-
--------+------+

|<i>      1 |         1 | SUBSCRIBE  | NULL       | NULL    |            0
</I>|<i> NULL              | NULL               | NULL                 |   0 |
</I>0 |    2 | 

|<i>      2 |         1 | PUBLISH    | NULL       | NULL    |            0
</I>|<i> NULL              | NULL               | NULL                 |   0 |
</I>0 |    2 | 

|<i>      3 |         1 | NULL       | Event      | NULL    |            0
</I>|<i> NULL              | .*presence.*       | NULL                 |   0 |
</I>1 |    5 | 

|<i>     27 |         7 | SUBSCRIBE  | NULL       | NULL    |            0
</I>|<i> NULL              | NULL               | NULL                 |   0 |
</I>0 |    2 | 

|<i>     28 |         7 | PUBLISH    | NULL       | NULL    |            0
</I>|<i> NULL              | NULL               | NULL                 |   0 |
</I>1 |    2 | 

+--------+-----------+------------+------------+---------+--------------
+-------------------+--------------------+----------------------+-----+-
--------+------+

5 rows in set (0.00 sec)

 

Trigger point ID 7 is what is used by me, and trigger point 1 is used by
the default service profile.

 

But in the scscf logs I dont see any triggers after recieving the
SUBSCRIBE. But there are some isc_matching when the Register message
arrives. 

 

Please let me know if you find something from the log files or any more
traces are needed.

 

Thanks in advance :)

 

Regards,

Kiran. 


The information contained in this electronic message and any attachments
to this message are intended for the exclusive use of the addressee(s)
and may contain proprietary, confidential or privileged information. If
you are not the intended recipient, you should not disseminate,
distribute or copy this e-mail. Please notify the sender immediately and
destroy all copies of this message and any attachments. 

WARNING: Computer viruses can be transmitted via email. The recipient
should check this email and any attachments for the presence of viruses.
The company accepts no liability for any damage caused by any virus
transmitted by this email.

www.wipro.com
	



The information contained in this electronic message and any attachments to this message are intended for the exclusive use of the addressee(s) and may contain proprietary, confidential or privileged information. If you are not the intended recipient, you should not disseminate, distribute or copy this e-mail. Please notify the sender immediately and destroy all copies of this message and any attachments. 

WARNING: Computer viruses can be transmitted via email. The recipient should check this email and any attachments for the presence of viruses. The company accepts no liability for any damage caused by any virus transmitted by this email.
 
www.wipro.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="https://lists.berlios.de/pipermail/openimscore-users/attachments/20070531/ff14b075/attachment.html">https://lists.berlios.de/pipermail/openimscore-users/attachments/20070531/ff14b075/attachment.html</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001895.html">[OpenIMSCore-Users] Trigger towards presence server
</A></li>
	<LI>Next message: <A HREF="001903.html">[OpenIMSCore-Users] Trigger towards presence server
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1901">[ date ]</a>
              <a href="thread.html#1901">[ thread ]</a>
              <a href="subject.html#1901">[ subject ]</a>
              <a href="author.html#1901">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/openimscore-users">More information about the OpenIMSCore-Users
mailing list</a><br>
</body></html>
