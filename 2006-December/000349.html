<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [OpenIMSCore-Users] During REGISTRATION: 500 Server Internal error	- Server assignment failed
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/openimscore-users/2006-December/index.html" >
   <LINK REL="made" HREF="mailto:openimscore-users%40lists.berlios.de?Subject=Re%3A%20%5BOpenIMSCore-Users%5D%20During%20REGISTRATION%3A%20500%20Server%20Internal%0A%20error%09-%20Server%20assignment%20failed&In-Reply-To=%3C4587DD93.8020406%40fokus.fraunhofer.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000341.html">
   <LINK REL="Next"  HREF="000333.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[OpenIMSCore-Users] During REGISTRATION: 500 Server Internal error	- Server assignment failed</H1>
    <B>Dragos Vingarzan</B> 
    <A HREF="mailto:openimscore-users%40lists.berlios.de?Subject=Re%3A%20%5BOpenIMSCore-Users%5D%20During%20REGISTRATION%3A%20500%20Server%20Internal%0A%20error%09-%20Server%20assignment%20failed&In-Reply-To=%3C4587DD93.8020406%40fokus.fraunhofer.de%3E"
       TITLE="[OpenIMSCore-Users] During REGISTRATION: 500 Server Internal error	- Server assignment failed">vingarzan at fokus.fraunhofer.de
       </A><BR>
    <I>Tue Dec 19 13:39:47 CET 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="000341.html">[OpenIMSCore-Users] During REGISTRATION: 500 Server Internal	error- Server assignment failed
</A></li>
        <LI>Next message: <A HREF="000333.html">[OpenIMSCore-Users] Not Registered! You must register first with a	S-CSCF
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#349">[ date ]</a>
              <a href="thread.html#349">[ thread ]</a>
              <a href="subject.html#349">[ subject ]</a>
              <a href="author.html#349">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi azerty200,

The errors regard the first REGISTER which does not contain an
Authorization header. This is mandatory in IMS as there is no other way
to determine the private identity of the user (we are using some
deprecated methods though).

The 500 is usually associated to a bad XML for the service profile, but
please fix the first issue first and see after that. I have also posted
a SIPp scenario on the list that contains registration - see Franz's
answer in this thread.

-Dragos

<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">azerty200 at free.fr</A> wrote:
&gt;<i> I'm trying to register Alice. I use Sipp.
</I>&gt;<i> I have trouble after the reception of the &quot;401 unauthorized&quot; message during the
</I>&gt;<i> registration, the s-cscf return an error:
</I>&gt;<i> 500 Server Internal error - Server assignment failed. I don't understand why?
</I>&gt;<i> Therefore, i have few errors in a p-cscf, s-cscf and I-cscf logs:
</I>&gt;<i>
</I>&gt;<i> P-CSCF
</I>&gt;<i>
</I>&gt;<i> ERR:P-CSCF:cscf_get_authorization: Message does not contain Authorization
</I>&gt;<i> header.
</I>&gt;<i>  2(18811) INF:P-CSCF:P_add_integrity_protected: No authorization header found.
</I>&gt;<i>  4(18813) INF:P-CSCF:cscf_get_transaction: Transaction 11621 414787487
</I>&gt;<i> exists.Retransmission?
</I>&gt;<i>
</I>&gt;<i> I-CSCF
</I>&gt;<i> ERR:I-CSCF:cscf_get_private_identity: Message does not contain Authorization
</I>&gt;<i> header.
</I>&gt;<i>  2(23507) INF:I-CSCF:cscf_get_private_identity: Falling back to
</I>&gt;<i> private_id=stripped(public_id)
</I>&gt;<i> -&gt; Message did not contain a valid Authorization Header!!! This fallback is
</I>&gt;<i> deprecated!
</I>&gt;<i> 18(1498) DBG:sm_process(): Peer hss.open-ims.test       State R_Open    Event
</I>&gt;<i> R_Rcv_Message
</I>&gt;<i>  2(23507) INFO:I-CSCF:Cx_get_result_code: Failed finding avp
</I>&gt;<i>  2(23507) INFO:I-CSCF:Cx_get_capabilities: Failed finding avp
</I>&gt;<i> 18(1498) DBG:sm_process(): Peer hss.open-ims.test       State R_Open    Event
</I>&gt;<i> R_Rcv_Message
</I>&gt;<i>  2(23507) INFO:I-CSCF:Cx_get_result_code: Failed finding avp
</I>&gt;<i>  2(23507) INFO:I-CSCF:Cx_get_capabilities: Failed finding avp
</I>&gt;<i> 17(23522) --- Peer List: ---
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> S-CSCF
</I>&gt;<i>
</I>&gt;<i> ERR:S-CSCF:cscf_get_integrity_protected: Message does not contain Authorization
</I>&gt;<i> header.
</I>&gt;<i>  1(12589) ERR:S-CSCF:cscf_get_nonce: Message does not contain Authorization
</I>&gt;<i> header.
</I>&gt;<i>  1(12589) ERR:S-CSCF:cscf_get_private_identity: Message does not contain
</I>&gt;<i> Authorization header.
</I>&gt;<i>  1(12589) INF:S-CSCF:cscf_get_private_identity: Falling back to
</I>&gt;<i> private_id=stripped(public_id)
</I>&gt;<i> -&gt; Message did not contain a valid Authorization Header!!! This fallback is
</I>&gt;<i> deprecated!
</I>&gt;<i>  1(12589) ERR:S-CSCF:cscf_get_algorithm: Message does not contain Authorization
</I>&gt;<i> header.
</I>&gt;<i>  1(12589) ERR:S-CSCF:cscf_get_auts: Message does not contain Authorization
</I>&gt;<i> header.
</I>&gt;<i> 18(12606) DBG:sm_process(): Peer hss.open-ims.test      State I_Open    Event
</I>&gt;<i> I_Rcv_Message
</I>&gt;<i>  3(12591) DBG:S-CSCF:S_is_authorized: UE said: eb30de6cf4f5bfcd, but we have
</I>&gt;<i> eb30de6cf4f5bfcd and expect 9ca27af86603607a4fbbcd84b754b207 ha1
</I>&gt;<i> 813933fa882e9cd606c1249e23f1cb5a
</I>&gt;<i>  3(12591) INFO:S-CSCF:S_is_authorized: Accepted client with non-MD5 AKAv1. Fix
</I>&gt;<i> the client!!!
</I>&gt;<i> 18(12606) DBG:sm_process(): Peer hss.open-ims.test      State I_Open    Event
</I>&gt;<i> I_Rcv_Message
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> The logs seem to mean that the Authorisation attribute is missing in the
</I>&gt;<i> registration's header. But they are present!
</I>&gt;<i> I notice that the P-CSCF add &quot;integrity-protected=&quot;no&quot; at the end of the
</I>&gt;<i> authentication attribute. And I think it's not normal.
</I>&gt;<i> I have joined my ethereal captures at this e-mail.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> My Sipp senario:
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> &lt;scenario name=&quot;OpenImsRegistrationtest&quot;&gt;
</I>&gt;<i> &lt;send retrans=&quot;5000&quot;&gt;
</I>&gt;<i> &lt;![CDATA[
</I>&gt;<i>
</I>&gt;<i> REGISTER sip:[field1] SIP/2.0
</I>&gt;<i> Via: SIP/2.0/[transport] [local_ip]:[local_port];branch=[branch]
</I>&gt;<i> Max-Forwards: 70
</I>&gt;<i> To: &lt;sip:[field0]@[field1]&gt;
</I>&gt;<i> From: &lt;sip:[field0]@[field1]&gt;;tag=[call_number]
</I>&gt;<i> Call-ID: [call_id]
</I>&gt;<i> CSeq: 1 REGISTER
</I>&gt;<i> Contact: sip:[field0]@[local_ip]:[local_port]
</I>&gt;<i> Expires: 600000
</I>&gt;<i> Content-Length: 0
</I>&gt;<i> ]]&gt;
</I>&gt;<i> &lt;/send&gt;
</I>&gt;<i> &lt;recv response=&quot;403&quot; optional=&quot;true&quot;&gt;&lt;/recv&gt;
</I>&gt;<i> &lt;recv response=&quot;401&quot; auth=&quot;true&quot;&gt;&lt;/recv&gt;
</I>&gt;<i>
</I>&gt;<i> &lt;send retrans=&quot;5000&quot;&gt;
</I>&gt;<i> &lt;![CDATA[
</I>&gt;<i>
</I>&gt;<i> REGISTER sip:[field1] SIP/2.0
</I>&gt;<i> [last_Via:]
</I>&gt;<i> Max-Forwards: 70
</I>&gt;<i> [last_To:]
</I>&gt;<i> [last_From:]
</I>&gt;<i> [authentication]
</I>&gt;<i> [last_CALL-ID:]
</I>&gt;<i> CSeq: 2 REGISTER
</I>&gt;<i> [last_Contact:]
</I>&gt;<i> Expires: 600000
</I>&gt;<i> Content-Length: 0
</I>&gt;<i> ]]&gt;
</I>&gt;<i> &lt;/send&gt;
</I>&gt;<i> &lt;recv response=&quot;403&quot; optional=&quot;true&quot;&gt;&lt;/recv&gt;
</I>&gt;<i> &lt;recv response=&quot;500&quot; optional=&quot;true&quot; r=&quot;true&quot;&gt;&lt;/recv&gt;
</I>&gt;<i> &lt;recv response=&quot;200&quot; rtd=&quot;true&quot;&gt;
</I>&gt;<i> &lt;/recv&gt;
</I>&gt;<i> &lt;/scenario&gt;
</I>&gt;<i>
</I>&gt;<i> Tks a lot for having read this e-mail until the end;)
</I>&gt;<i> And tks for your future answers.
</I>&gt;<i> ------------------------------------------------------------------------
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> OpenIMSCore-Users mailing list
</I>&gt;<i> <A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">OpenIMSCore-Users at lists.berlios.de</A>
</I>&gt;<i> <A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">https://lists.berlios.de/mailman/listinfo/openimscore-users</A>
</I>&gt;<i>   
</I>

-- 
-----------------------------------------
Dipl. Eng. Dragos Vingarzan
FOKUS/NGNI
Kaiserin-Augusta-Allee 31
10589 Berlin,Germany
Phone +49 (0)30 - 3463 - 7385
Mobile +49 (0)163 - 159 - 5221
eMail <A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">vingarzan at fokus.fraunhofer.de</A>
Web www.fokus.fraunhofer.de
We could change the world if God would give us the source code...
-----------------------------------------------------------------



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000341.html">[OpenIMSCore-Users] During REGISTRATION: 500 Server Internal	error- Server assignment failed
</A></li>
	<LI>Next message: <A HREF="000333.html">[OpenIMSCore-Users] Not Registered! You must register first with a	S-CSCF
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#349">[ date ]</a>
              <a href="thread.html#349">[ thread ]</a>
              <a href="subject.html#349">[ subject ]</a>
              <a href="author.html#349">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/openimscore-users">More information about the OpenIMSCore-Users
mailing list</a><br>
</body></html>
