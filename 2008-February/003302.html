<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [OpenIMSCore-Users] &#31572;&#22797;:  Registration Failure of 403 Forbidden - HSS User Unknown
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/openimscore-users/2008-February/index.html" >
   <LINK REL="made" HREF="mailto:openimscore-users%40lists.berlios.de?Subject=Re%3A%20%5BOpenIMSCore-Users%5D%0A%20%3D%3Fgb2312%3Fb%3FtPC4tDogIFJlZ2lzdHJhdGlvbiBGYWls%3F%3D%0A%20%3D%3Fgb2312%3Fb%3FdXJlIG9mIDQwMyBGb3JiaWRkZW4gLSBIU1MgVXNlciBVbmtub3du%3F%3D&In-Reply-To=%3C47A35A34.2040502%40fokus.fraunhofer.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003286.html">
   <LINK REL="Next"  HREF="003287.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[OpenIMSCore-Users] &#31572;&#22797;:  Registration Failure of 403 Forbidden - HSS User Unknown</H1>
    <B>Dragos Vingarzan</B> 
    <A HREF="mailto:openimscore-users%40lists.berlios.de?Subject=Re%3A%20%5BOpenIMSCore-Users%5D%0A%20%3D%3Fgb2312%3Fb%3FtPC4tDogIFJlZ2lzdHJhdGlvbiBGYWls%3F%3D%0A%20%3D%3Fgb2312%3Fb%3FdXJlIG9mIDQwMyBGb3JiaWRkZW4gLSBIU1MgVXNlciBVbmtub3du%3F%3D&In-Reply-To=%3C47A35A34.2040502%40fokus.fraunhofer.de%3E"
       TITLE="[OpenIMSCore-Users] &#31572;&#22797;:  Registration Failure of 403 Forbidden - HSS User Unknown">Dragos.Vingarzan at fokus.fraunhofer.de
       </A><BR>
    <I>Fri Feb  1 18:43:16 CET 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="003286.html">[OpenIMSCore-Users] &#31572;&#22797;:  Registration Failure of 403 Forbidden - HSS User Unknown
</A></li>
        <LI>Next message: <A HREF="003287.html">[OpenIMSCore-Users] &#31572;&#22797;: OpenIMSCore-Users Digest, Vol 15, Issue 56
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3302">[ date ]</a>
              <a href="thread.html#3302">[ thread ]</a>
              <a href="subject.html#3302">[ subject ]</a>
              <a href="author.html#3302">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Yes... for the I/S-CSCF there is no way to get what IMPI (you call it
PVI, I guess) is your client trying to use. So then it is derived simply
from the IMPU (PUI).

If you want to use a different one, make your IAD always send an
Authorization header with the desired IMPI inside. Old SIP clients don't
because the IMPI was not deemed necessary to use before the 401
challenge. But for IMS it is, because your IMPU could be associated to
multiple IMPI (SIM cards let's say) and they do not share the same
secret such that the core network must know it in advance in order to
generate the right challenge, that also authorizes the network to the
user (in case of AKA).

There is still a discussion on what happens when CableLabs/TISPAN would
say that you do not need an IMPI transmitted in the first request, but
that's convergence soup...

-Dragos



<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">jun.wen at msn.com</A> wrote:
&gt;<i> Hi, Dragos,
</I>&gt;<i>
</I>&gt;<i> Thanks for your indication. 
</I>&gt;<i>
</I>&gt;<i> In fact I did create a PVI with <A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">testuser1 at open-ims.test</A> with PUI by
</I>&gt;<i> sip:<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">1001 at open-ims.test.</A> While the registration was always failed as the
</I>&gt;<i> attached 403 Forbidden -HSS User Unknown. By going through your previous
</I>&gt;<i> email archives, some guys stressed the PVI must be identical with the body
</I>&gt;<i> of PUI. When I changed PVI with <A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">1001 at open-ims.test</A>, the registration was
</I>&gt;<i> well done and I completed call between two analog phones through a
</I>&gt;<i> Grandstream SIP-IAD.
</I>&gt;<i>
</I>&gt;<i> Is there any specific reason to keep same of them ?
</I>&gt;<i>
</I>&gt;<i> Regards
</I>&gt;<i>
</I>&gt;<i> Jun 
</I>&gt;<i>
</I>&gt;<i> -----&#37038;&#20214;&#21407;&#20214;-----
</I>&gt;<i> &#21457;&#20214;&#20154;: Dragos Vingarzan [mailto:<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">Dragos.Vingarzan at fokus.fraunhofer.de</A>] 
</I>&gt;<i> &#21457;&#36865;&#26102;&#38388;: 2008&#24180;2&#26376;1&#26085; 0:33
</I>&gt;<i> &#25910;&#20214;&#20154;: <A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">jun.wen at msn.com</A>
</I>&gt;<i> &#25220;&#36865;: <A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">openimscore-users at lists.berlios.de</A>
</I>&gt;<i> &#20027;&#39064;: Re: [OpenIMSCore-Users] Registration Failure of 403 Forbidden - HSS
</I>&gt;<i> User Unknown
</I>&gt;<i>
</I>&gt;<i> Hi Jun,
</I>&gt;<i>
</I>&gt;<i> There is no Authorization header... so your client does not send a
</I>&gt;<i> private identity. The it is derived from the public identity, as
</I>&gt;<i> &quot;<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">1001 at open-ims.test</A>&quot;. Do you actually have such a private identity in
</I>&gt;<i> the database?
</I>&gt;<i>
</I>&gt;<i> Regards,
</I>&gt;<i> -Dragos
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> <A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">jun.wen at msn.com</A> wrote:
</I>&gt;<i>   
</I>&gt;&gt;<i> Hi, Team,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> When I performed registration from a Grandstream SIP-IAD by
</I>&gt;&gt;<i> sip:<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">testuser at open-ims.test</A>, everything was going well. Whereas, when I
</I>&gt;&gt;<i> turned to sip:<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">1001 at open-ims.test</A>, there was always failed with 403
</I>&gt;&gt;<i>     
</I>&gt;<i> Forbidden
</I>&gt;<i>   
</I>&gt;&gt;<i> - HSS User Unknown. 
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Both sip:testuser and sip:1001 were created in HSS and uctimsclient could
</I>&gt;&gt;<i> complete registration with both of them. 
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> The attachment is the registration log from P-CSCF to I-CSCF of
</I>&gt;&gt;<i> sip:<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">1001 at open-ims.test.</A>  Immediately I-CSCF returned 403 Forbidden - HSS
</I>&gt;&gt;<i> User Unknown to P-CSCF.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>     
</I>&gt;<i> ----------------------------------------------------------------------------
</I>&gt;<i>   
</I>&gt;&gt;<i> ------------------------------------------------
</I>&gt;&gt;<i> Frame 325 (790 bytes on wire, 790 bytes captured)
</I>&gt;&gt;<i> Linux cooked capture
</I>&gt;&gt;<i> Internet Protocol, Src: 192.168.2.73 (192.168.2.73), Dst: 192.168.2.73
</I>&gt;&gt;<i> (192.168.2.73)
</I>&gt;&gt;<i> User Datagram Protocol, Src Port: 4060 (4060), Dst Port: 5060 (5060)
</I>&gt;&gt;<i> Session Initiation Protocol
</I>&gt;&gt;<i>     Request-Line: REGISTER sip:open-ims.test SIP/2.0
</I>&gt;&gt;<i>         Method: REGISTER
</I>&gt;&gt;<i>         [Resent Packet: False]
</I>&gt;&gt;<i>     Message Header
</I>&gt;&gt;<i>         Via: SIP/2.0/UDP 192.168.2.73:4060;branch=z9hG4bK1371.b98fa853.0
</I>&gt;&gt;<i>         Via: SIP/2.0/UDP
</I>&gt;&gt;<i> 192.168.2.101:5064;rport=5064;branch=z9hG4bKcb411b9df8949bdb
</I>&gt;&gt;<i>         From: &quot;HT496-Port1&quot; &lt;sip:<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">1001 at open-ims.test</A>&gt;;tag=d27b2c7b7c7bd42a
</I>&gt;&gt;<i>             SIP Display info: &quot;HT496-Port1&quot; 
</I>&gt;&gt;<i>             SIP from address: sip:<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">1001 at open-ims.test</A>
</I>&gt;&gt;<i>             SIP tag: d27b2c7b7c7bd42a
</I>&gt;&gt;<i>         To: &lt;sip:<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">1001 at open-ims.test</A>&gt;
</I>&gt;&gt;<i>             SIP to address: sip:<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">1001 at open-ims.test</A>
</I>&gt;&gt;<i>         Contact: &lt;sip:<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">1001 at 192.168.2.101</A>:5064&gt;
</I>&gt;&gt;<i>             Contact Binding: &lt;sip:<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">1001 at 192.168.2.101</A>:5064&gt;
</I>&gt;&gt;<i>                 URI: &lt;sip:<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">1001 at 192.168.2.101</A>:5064&gt;
</I>&gt;&gt;<i>                     SIP contact address: sip:<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">1001 at 192.168.2.101</A>:5064
</I>&gt;&gt;<i>         Call-ID: <A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">8df19d085656db5f at 192.168.2.101</A>
</I>&gt;&gt;<i>         CSeq: 100 REGISTER
</I>&gt;&gt;<i>         Expires: 3600
</I>&gt;&gt;<i>         User-Agent: Grandstream HT496 1.0.3.64 FXS0
</I>&gt;&gt;<i>         Max-Forwards: 16
</I>&gt;&gt;<i>         Allow: INVITE,ACK,CANCEL,BYE,NOTIFY,REFER,OPTIONS,INFO,SUBSCRIBE
</I>&gt;&gt;<i>         Content-Length: 0
</I>&gt;&gt;<i>         Path: &lt;sip:<A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">term at pcscf.open-ims.test</A>:4060;lr&gt;
</I>&gt;&gt;<i>         Require: path
</I>&gt;&gt;<i>         P-Charging-Vector:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>     
</I>&gt;<i> icid-value=&quot;P-CSCFabcd479d72da00000020&quot;;icid-generated-at=192.168.2.73;orig-
</I>&gt;<i>   
</I>&gt;&gt;<i> ioi=&quot;open-ims.test&quot;
</I>&gt;&gt;<i>         P-Visited-Network-ID: open-ims.test
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>     
</I>&gt;<i> ----------------------------------------------------------------------------
</I>&gt;<i>   
</I>&gt;&gt;<i> ------------------------------------------------
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Regards
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Jun
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i> OpenIMSCore-Users mailing list
</I>&gt;&gt;<i> <A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">OpenIMSCore-Users at lists.berlios.de</A>
</I>&gt;&gt;<i> <A HREF="https://lists.berlios.de/mailman/listinfo/openimscore-users">https://lists.berlios.de/mailman/listinfo/openimscore-users</A>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>   
</I>&gt;&gt;<i>     
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>   
</I>

-- 
-----------------------------------------
Dipl. Eng. Dragos Vingarzan
Fraunhofer FOKUS/NGNI
Kaiserin-Augusta-Allee 31
10589 Berlin,Germany
Phone +49 (0)30 - 3463 - 7385
Mobile +49 (0)176 - 48 32 16 00
Web www.fokus.fraunhofer.de www.openimscore.org
We could change the world if God would give us the source code...
-----------------------------------------------------------------


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003286.html">[OpenIMSCore-Users] &#31572;&#22797;:  Registration Failure of 403 Forbidden - HSS User Unknown
</A></li>
	<LI>Next message: <A HREF="003287.html">[OpenIMSCore-Users] &#31572;&#22797;: OpenIMSCore-Users Digest, Vol 15, Issue 56
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3302">[ date ]</a>
              <a href="thread.html#3302">[ thread ]</a>
              <a href="subject.html#3302">[ subject ]</a>
              <a href="author.html#3302">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/openimscore-users">More information about the OpenIMSCore-Users
mailing list</a><br>
</body></html>
